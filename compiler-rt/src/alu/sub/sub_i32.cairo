use crate::alu::sub::sub;

pub fn __llvm_sub_i_i_i(lhs: u128, rhs: u128) -> u128 {
    sub::<u32>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use super::__llvm_sub_i_i_i;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 129] = [
        // Due to Cairo's casting limitation, negative numbers are represented as bit patterns.

        // Random test cases
        TestCaseTwoArgs{lhs: 0b10011100000100000110011000100000, rhs: 0b10101000001000101111100011001010, expected: 4092423510}, // lhs = -1676646880 rhs = -1474103094
        TestCaseTwoArgs{lhs: 1741247310, rhs: 1199787481, expected: 541459829},
        TestCaseTwoArgs{lhs: 0b11010111000101100111010000001111, rhs: 0b10111011001111011001010101011011, expected: 467197620}, // lhs = -686394353 rhs = -1153591973
        TestCaseTwoArgs{lhs: 2062192469, rhs: 631246501, expected: 1430945968},
        TestCaseTwoArgs{lhs: 0b10000110010110011110101101111110, rhs: 0b10011000101001110000001100001011, expected: 3987925107}, // lhs = -2040927362 rhs = -1733885173
        TestCaseTwoArgs{lhs: 0b11001010100010100110000001101100, rhs: 0b10110011000110111010101111100000, expected: 393131148}, // lhs = -896901012 rhs = -1290032160
        TestCaseTwoArgs{lhs: 0b10001001100100010010011010000010, rhs: 0b11110011101100111101001010111010, expected: 2514310088}, // lhs = -1986976126 rhs = -206318918
        TestCaseTwoArgs{lhs: 878006065, rhs: 1894368762, expected: 3278604599},
        TestCaseTwoArgs{lhs: 122269471, rhs: 0b11100000010101111101101001110110, expected: 653382825}, // rhs = -531113354
        TestCaseTwoArgs{lhs: 0b11110011110111001110111010110011, rhs: 0b10001011110111001011110011111010, expected: 1744843193}, // lhs = -203624781 rhs = -1948467974
        TestCaseTwoArgs{lhs: 0b10100011111101000001000000001011, rhs: 1196859010, expected: 1553822089}, // lhs = -1544286197
        TestCaseTwoArgs{lhs: 0b10101100101000110111101111110010, rhs: 0b11110001000100000100101100100000, expected: 3146985682}, // lhs = -1398572046 rhs = -250590432
        TestCaseTwoArgs{lhs: 0b11010101111110110011101101100100, rhs: 718561138, expected: 2871450610}, // lhs = -704955548
        TestCaseTwoArgs{lhs: 1061808485, rhs: 2099323648, expected: 3257452133},
        TestCaseTwoArgs{lhs: 2069930189, rhs: 0b10101100111110000010010110000100, expected: 3462953801}, // rhs = -1393023612
        TestCaseTwoArgs{lhs: 1174412392, rhs: 590894085, expected: 583518307},
        TestCaseTwoArgs{lhs: 0b11011110100000101011100100011001, rhs: 1654989445, expected: 2078119572}, // lhs = -561858279
        TestCaseTwoArgs{lhs: 0b10100011100110101100101000110100, rhs: 0b11010100010111000000110001100000, expected: 3476995540}, // lhs = -1550136780 rhs = -732165024
        TestCaseTwoArgs{lhs: 217432140, rhs: 930034888, expected: 3582364548},
        TestCaseTwoArgs{lhs: 322916560, rhs: 0b11010001000110111000010110000010, expected: 1109642062}, // rhs = -786725502
        TestCaseTwoArgs{lhs: 1987543333, rhs: 1335178009, expected: 652365324},
        TestCaseTwoArgs{lhs: 1014981007, rhs: 0b11111001110010100001011000110100, expected: 1119177563}, // rhs = -104196556
        TestCaseTwoArgs{lhs: 0b10000001011010111001011001111100, rhs: 429083616, expected: 1742228124}, // lhs = -2123655556
        TestCaseTwoArgs{lhs: 316457354, rhs: 2093671317, expected: 2517753333},
        TestCaseTwoArgs{lhs: 1391764295, rhs: 316821972, expected: 1074942323},
        TestCaseTwoArgs{lhs: 0b11010110000101101010001111110101, rhs: 398548795, expected: 3193259194}, // lhs = -703159307
        TestCaseTwoArgs{lhs: 333279411, rhs: 0b10011101000000001000011000010010, expected: 1994189473}, // rhs = -1660910062
        TestCaseTwoArgs{lhs: 0b11100011101001110100100110100111, rhs: 0b11010000011000011000010011000011, expected: 323339492}, // lhs = -475575897 rhs = -798915389
        TestCaseTwoArgs{lhs: 0b11110010111100111000010000100010, rhs: 782486691, expected: 3293558655}, // lhs = -218921950
        TestCaseTwoArgs{lhs: 0b10001011000001100100100100101111, rhs: 0b11110011001111010001101000100101, expected: 2546544394}, // lhs = -1962522321 rhs = -214099419
        TestCaseTwoArgs{lhs: 0b10110010111100111001101000110100, rhs: 0b10000000011101111011010011010011, expected: 846980449}, // lhs = -1292658124 rhs = -2139638573
        TestCaseTwoArgs{lhs: 1029135025, rhs: 0b10010110001110100111011110011000, expected: 2803688217}, // rhs = -1774553192
        TestCaseTwoArgs{lhs: 1665839374, rhs: 1262059736, expected: 403779638},
        TestCaseTwoArgs{lhs: 0b10000001010011101110001000011101, rhs: 119309454, expected: 2050121103}, // lhs = -2125536739
        TestCaseTwoArgs{lhs: 1414592464, rhs: 0b10100110000111110110100001110011, expected: 2922483549}, // rhs = -1507891085
        TestCaseTwoArgs{lhs: 0b10001100000011010100010001110110, rhs: 0b10111111111000110011101001010001, expected: 3425307173}, // lhs = -1945287562 rhs = -1075627439
        TestCaseTwoArgs{lhs: 1449914392, rhs: 1895723604, expected: 3849158084},
        TestCaseTwoArgs{lhs: 162079783, rhs: 413516134, expected: 4043530945},
        TestCaseTwoArgs{lhs: 0b11100101001100001101110011100111, rhs: 0b11011011010010000001001000100100, expected: 166251203}, // lhs = -449782553 rhs = -616033756
        TestCaseTwoArgs{lhs: 0b10111110011000001010100100101101, rhs: 380362570, expected: 2813643235}, // lhs = -1100961491
        TestCaseTwoArgs{lhs: 2059827349, rhs: 0b10010100100010010101000010101110, expected: 3862767591}, // rhs = -1802940242
        TestCaseTwoArgs{lhs: 0b10101010011000110100001011000111, rhs: 152131360, expected: 2706500519}, // lhs = -1436335417
        TestCaseTwoArgs{lhs: 2055727917, rhs: 0b11000010101001111100110001001110, expected: 3084918495}, // rhs = -1029190578
        TestCaseTwoArgs{lhs: 0b10110000110000101110111011111000, rhs: 0b11011100010100000000101000000101, expected: 3564299507}, // lhs = -1329402120 rhs = -598734331
        TestCaseTwoArgs{lhs: 361413025, rhs: 70687366, expected: 290725659},
        TestCaseTwoArgs{lhs: 0b10100111000001100101001010111010, rhs: 0b10000010101001010100100000001111, expected: 610339499}, // lhs = -1492757830 rhs = -2103097329
        TestCaseTwoArgs{lhs: 0b11000000111000001110000110100000, rhs: 34537589, expected: 3201425707}, // lhs = -1059004000
        TestCaseTwoArgs{lhs: 0b11011100110011011000001011111110, rhs: 0b11011000110000000111001111101000, expected: 67964694}, // lhs = -590511362 rhs = -658476056
        TestCaseTwoArgs{lhs: 2086819597, rhs: 0b10000000010101000111000001001110, expected: 4228769471}, // rhs = -2141949874
        TestCaseTwoArgs{lhs: 1051262927, rhs: 1040695402, expected: 10567525},
        TestCaseTwoArgs{lhs: 0b10011001011010011010011101111111, rhs: 1894636964, expected: 679201243}, // lhs = -1721129089
        TestCaseTwoArgs{lhs: 667377856, rhs: 0b11011001010000010100100110101011, expected: 1317410581}, // rhs = -650032725
        TestCaseTwoArgs{lhs: 0b10110001100010011100011001110011, rhs: 700550638, expected: 2278045829}, // lhs = -1316370829
        TestCaseTwoArgs{lhs: 0b11100000100000101110001010000010, rhs: 1799709948, expected: 1966964102}, // lhs = -528293246
        TestCaseTwoArgs{lhs: 1027770081, rhs: 0b10011001100100110011000000110011, expected: 2746177198}, // rhs = -1718407117
        TestCaseTwoArgs{lhs: 880257023, rhs: 727159229, expected: 153097794},
        TestCaseTwoArgs{lhs: 1044261927, rhs: 1351078336, expected: 3988150887},
        TestCaseTwoArgs{lhs: 197763100, rhs: 522117914, expected: 3970612482},
        TestCaseTwoArgs{lhs: 1455861750, rhs: 1355352898, expected: 100508852},
        TestCaseTwoArgs{lhs: 0b11011000011000011010101110110110, rhs: 0b11011010001111110111100011100110, expected: 4263654096}, // lhs = -664687690 rhs = -633374490
        TestCaseTwoArgs{lhs: 1326599143, rhs: 327454585, expected: 999144558},
        TestCaseTwoArgs{lhs: 1798501302, rhs: 1532462452, expected: 266038850},
        TestCaseTwoArgs{lhs: 0b11001100000110001001000011001010, rhs: 1656880994, expected: 1767281000}, // lhs = -870805302
        TestCaseTwoArgs{lhs: 0b11000001000110011111000100001010, rhs: 0b11111000001111100110000000011111, expected: 3369832683}, // lhs = -1055264502 rhs = -130129889
        TestCaseTwoArgs{lhs: 1025344003, rhs: 0b11000000101110101111101101100001, expected: 2086831778}, // rhs = -1061487775
        TestCaseTwoArgs{lhs: 0b11010110010111100000101101100000, rhs: 0b10010111011010001011001001111111, expected: 1056266465}, // lhs = -698479776 rhs = -1754746241
        TestCaseTwoArgs{lhs: 571316789, rhs: 1626198578, expected: 3240085507},
        TestCaseTwoArgs{lhs: 702622123, rhs: 1508314454, expected: 3489274965},
        TestCaseTwoArgs{lhs: 0b11011110111110010110001011110110, rhs: 747940053, expected: 2992945697}, // lhs = -554081546
        TestCaseTwoArgs{lhs: 0b11110010100101011010000001100100, rhs: 27474309, expected: 4042417887}, // lhs = -225075100
        TestCaseTwoArgs{lhs: 311596452, rhs: 2075444987, expected: 2531118761},
        TestCaseTwoArgs{lhs: 1548985272, rhs: 0b10111000000010001000110011101001, expected: 2756384463}, // rhs = -1207399191
        TestCaseTwoArgs{lhs: 1785927925, rhs: 0b10010001100000110011011001110111, expected: 3639599742}, // rhs = -1853671817
        TestCaseTwoArgs{lhs: 0b11011000110000011111011000110111, rhs: 0b11010000110011010101000001001110, expected: 133473769}, // lhs = -658377161 rhs = -791850930
        TestCaseTwoArgs{lhs: 0b10100111100010011110001111001110, rhs: 0b10010000100110001011001100101110, expected: 384905376}, // lhs = -1484135474 rhs = -1869040850
        TestCaseTwoArgs{lhs: 23157853, rhs: 1092492222, expected: 3225632927},
        TestCaseTwoArgs{lhs: 1945771480, rhs: 1570672627, expected: 375098853},
        TestCaseTwoArgs{lhs: 0b10010101010100011101010110111111, rhs: 1288114878, expected: 1217053441}, // lhs = -1789798977
        TestCaseTwoArgs{lhs: 0b10001111001101111100110111000111, rhs: 113920572, expected: 2288878475}, // lhs = -1892168249
        TestCaseTwoArgs{lhs: 773408917, rhs: 0b10010011001101010011001011000100, expected: 2598639057}, // rhs = -1825230140
        TestCaseTwoArgs{lhs: 617081310, rhs: 211400839, expected: 405680471},
        TestCaseTwoArgs{lhs: 1207335296, rhs: 834798157, expected: 372537139},
        TestCaseTwoArgs{lhs: 2117993182, rhs: 0b11001000110100101010011100011101, expected: 3043711937}, // rhs = -925718755
        TestCaseTwoArgs{lhs: 359459617, rhs: 269739908, expected: 89719709},
        TestCaseTwoArgs{lhs: 0b11101010011011001111001000100001, rhs: 0b11001001101011101011010010100010, expected: 549338495}, // lhs = -361958879 rhs = -911297374
        TestCaseTwoArgs{lhs: 0b10011000011111100011111000000001, rhs: 0b11101010100110100010100111111101, expected: 2917405700}, // lhs = -1736557055 rhs = -358995459
        TestCaseTwoArgs{lhs: 836133401, rhs: 0b11001011000001101011010110101100, expected: 1724886125}, // rhs = -888752724
        TestCaseTwoArgs{lhs: 0b10100011110101000110100010110000, rhs: 858327346, expected: 1890279294}, // lhs = -1546360656
        TestCaseTwoArgs{lhs: 0b11000110111111110010001111110110, rhs: 0b10101110100111100001001000100011, expected: 409014739}, // lhs = -956357642 rhs = -1365372381
        TestCaseTwoArgs{lhs: 1786855424, rhs: 1666446627, expected: 120408797},
        TestCaseTwoArgs{lhs: 0b10100100101010101001000011111101, rhs: 1369140879, expected: 1393500782}, // lhs = -1532325635
        TestCaseTwoArgs{lhs: 0b11101001011100100110100111010000, rhs: 910000696, expected: 3006588824}, // lhs = -378377776
        TestCaseTwoArgs{lhs: 0b11110000010000000101110101101001, rhs: 2012753909, expected: 2017996148}, // lhs = -264217239
        TestCaseTwoArgs{lhs: 0b11110101001100010101100010010100, rhs: 0b11111001101001000000010101101011, expected: 4220343081}, // lhs = -181315436 rhs = -106691221
        TestCaseTwoArgs{lhs: 848641617, rhs: 0b10101101001000101010010110010011, expected: 2238879934}, // rhs = -1390238317
        TestCaseTwoArgs{lhs: 667925707, rhs: 0b11011000001011111010110111100010, expected: 1335889641}, // rhs = -667963934
        TestCaseTwoArgs{lhs: 1234999807, rhs: 987026040, expected: 247973767},
        TestCaseTwoArgs{lhs: 0b11000011100010100101111111001111, rhs: 2081574209, expected: 1199051406}, // lhs = -1014341681
        TestCaseTwoArgs{lhs: 262307634, rhs: 0b11010111111100000110000000011011, expected: 934420247}, // rhs = -672112613
        TestCaseTwoArgs{lhs: 151526190, rhs: 258553141, expected: 4187940345},
        TestCaseTwoArgs{lhs: 0b10111100011010011000111010011010, rhs: 0b10000001000000011000010111111101, expected: 996673693}, // lhs = -1133932902 rhs = -2130606595
        TestCaseTwoArgs{lhs: 2022468360, rhs: 1376584446, expected: 645883914},
        TestCaseTwoArgs{lhs: 1980042401, rhs: 0b11011001101111100011011100111111, expected: 2621887842}, // rhs = -641845441
        TestCaseTwoArgs{lhs: 0b10101110111010110100111010110100, rhs: 1869351926, expected: 1065304766}, // lhs = -1360310604
        TestCaseTwoArgs{lhs: 0b11001110010000100111101101110100, rhs: 1873844836, expected: 1586618640}, // lhs = -834503820
        TestCaseTwoArgs{lhs: 169411041, rhs: 0b11000001111000010110111001010110, expected: 1211601803}, // rhs = -1042190762
        TestCaseTwoArgs{lhs: 0b11010001101101001100110101001101, rhs: 252668253, expected: 3265618928}, // lhs = -776680115
        TestCaseTwoArgs{lhs: 515615288, rhs: 0b11101111001001101101101101001011, expected: 798281453}, // rhs = -282666165
        TestCaseTwoArgs{lhs: 186232421, rhs: 947234727, expected: 3533964990},
        TestCaseTwoArgs{lhs: 120757286, rhs: 460634963, expected: 3955089619},
        TestCaseTwoArgs{lhs: 1838848838, rhs: 930464855, expected: 908383983},
        TestCaseTwoArgs{lhs: 90763138, rhs: 421026362, expected: 3964704072},
        TestCaseTwoArgs{lhs: 2064679866, rhs: 2009498741, expected: 55181125},
        TestCaseTwoArgs{lhs: 0b10001101101010110000001101011111, rhs: 17478462, expected: 2359316513}, // lhs = -1918172321
        TestCaseTwoArgs{lhs: 0b10101111001111111110000101000000, rhs: 0b10000110100010100000101001100101, expected: 683005659}, // lhs = -1354768064 rhs = -2037773723
        TestCaseTwoArgs{lhs: 1266700735, rhs: 0b11011101011000111010010101110100, expected: 1847372875}, // rhs = -580672140
        TestCaseTwoArgs{lhs: 0b11100100110011011101101011010110, rhs: 0b10001010001000110001101101100000, expected: 1521139574}, // lhs = -456271146 rhs = -1977410720
        TestCaseTwoArgs{lhs: 0b11001000000010101010111111101001, rhs: 500111324, expected: 2856032269}, // lhs = -938823703
        TestCaseTwoArgs{lhs: 0b10001000000011011100100000100100, rhs: 2016300054, expected: 266304526}, // lhs = -2012362716
        TestCaseTwoArgs{lhs: 0b10001101101111001011111011111101, rhs: 1854449189, expected: 523507928}, // lhs = -1917010179

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 0, expected: 0},
        TestCaseTwoArgs{lhs: 0, rhs: 2147483647, expected: 2147483649},
        TestCaseTwoArgs{lhs: 0, rhs: 0b10000000000000000000000000000000, expected: 2147483648}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0, expected: 2147483647},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 2147483647, expected: 0},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0b10000000000000000000000000000000, expected: 4294967295}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0, expected: 2147483648}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 2147483647, expected: 1}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0b10000000000000000000000000000000, expected: 0}, // lhs = -2147483648 rhs = -2147483648
    ];
    #[test]
    fn test_i32() {
        for case in test_cases.span() {
            assert_eq!(__llvm_sub_i_i_i(*case.lhs, *case.rhs), *case.expected);
        }
    }
}
