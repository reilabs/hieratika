use crate::alu::sdiv::sdiv;
use crate::integer::u48::u48;

pub fn __llvm_sdiv_k_k_k(lhs: u128, rhs: u128) -> u128 {
    sdiv::<u48>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use super::__llvm_sdiv_k_k_k;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 246] = [
        // Due to Cairo's casting limitation, negative numbers are represented as bit patterns.

        // Random test cases
        TestCaseTwoArgs{lhs: 47891677830145, rhs: 0b110001101101000110111100110001001111001101001100, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -62870859222196 expected = -1
        TestCaseTwoArgs{lhs: 38708314984479, rhs: 0b111001110100000011100110011110000001101100010010, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -27209046156526 expected = -2
        TestCaseTwoArgs{lhs: 120780824447808, rhs: 0b101110010011001111110000100101110000110010111110, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -77842245808962 expected = -2
        TestCaseTwoArgs{lhs: 129484985774351, rhs: 0b111001110100001011000001000010111000100111010011, expected: 0b111111111111111111111111111111111111111111111011}, // rhs = -27201084093997 expected = -5
        TestCaseTwoArgs{lhs: 0b111100010110111000001001001011101001100000111011, rhs: 139600719269383, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -16020073965509 expected = -1
        TestCaseTwoArgs{lhs: 0b101001100000010010111000101000001111011101111110, rhs: 0b101011011011100011000011011010100001000110011101, expected: 1}, // lhs = -98935769073794 rhs = -90465912614499
        TestCaseTwoArgs{lhs: 63884589349524, rhs: 79608452475057, expected: 0},
        TestCaseTwoArgs{lhs: 10221700782017, rhs: 138528016374084, expected: 0},
        TestCaseTwoArgs{lhs: 0b111000001001001001110111111001011101000000010010, rhs: 13416662751258, expected: 0b111111111111111111111111111111111111111111111101}, // lhs = -34555295313902 expected = -3
        TestCaseTwoArgs{lhs: 82390769229414, rhs: 0b110101101000101110111011000100001111011001111011, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -45579349461381 expected = -2
        TestCaseTwoArgs{lhs: 100072166843102, rhs: 116471892757289, expected: 0},
        TestCaseTwoArgs{lhs: 0b110010110001100100001110011101100010000010010001, rhs: 0b100001110011111100110100000111001001000001101000, expected: 0}, // lhs = -58166499467119 rhs = -132769449734040
        TestCaseTwoArgs{lhs: 0b101001011110110011101111001101010111011010101011, rhs: 3804676271704, expected: 0b111111111111111111111111111111111111111111100101}, // lhs = -99037932587349 expected = -27
        TestCaseTwoArgs{lhs: 12668479904349, rhs: 135089052421981, expected: 0},
        TestCaseTwoArgs{lhs: 0b111000110000101101011011101100110011000001110011, rhs: 0b100010110101010100100000101111101010111100001100, expected: 0}, // lhs = -31837054095245 rhs = -128277238862068
        TestCaseTwoArgs{lhs: 0b111010100011010011111100111100001001011111000110, rhs: 135972867510591, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -23961673885754 expected = -1
        TestCaseTwoArgs{lhs: 0b100011111100101000011110000000001100010010101011, rhs: 50923856880099, expected: 0b111111111111111111111111111111111111111111111101}, // lhs = -123376727178069 expected = -3
        TestCaseTwoArgs{lhs: 0b111100010000001101110110011010000110100000100001, rhs: 123681325928202, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -16477802960863 expected = -1
        TestCaseTwoArgs{lhs: 0b101101001011111001011111001011111100010111011011, rhs: 0b111010111010111000100011100000100011100110000101, expected: 3}, // lhs = -82745242958373 rhs = -22341824136827
        TestCaseTwoArgs{lhs: 48733252750008, rhs: 27485541024805, expected: 1},
        TestCaseTwoArgs{lhs: 0b111101101011000011111000000100111000011111000111, rhs: 0b101100101001100000000000101000001011010111100011, expected: 0}, // lhs = -10235040004153 rhs = -85109061405213
        TestCaseTwoArgs{lhs: 85556933697261, rhs: 0b101010100111110001011111000000011001011110101110, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -94023830104146 expected = -1
        TestCaseTwoArgs{lhs: 85438176954153, rhs: 0b101101111001000101101011111010011100100110000110, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -79639768086138 expected = -2
        TestCaseTwoArgs{lhs: 118022059206248, rhs: 0b101111101100001000011010111000110110101110010110, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -71734092665962 expected = -2
        TestCaseTwoArgs{lhs: 0b100111100001111100001001111110011110011000101110, rhs: 134789752889936, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -107618828163538 expected = -1
        TestCaseTwoArgs{lhs: 128241998470089, rhs: 0b110110010011010011100101110000000110000000010110, expected: 0b111111111111111111111111111111111111111111111100}, // rhs = -42653760593898 expected = -4
        TestCaseTwoArgs{lhs: 0b100011000010100000011011001010101010110000101100, rhs: 40913966205430, expected: 0b111111111111111111111111111111111111111111111100}, // lhs = -127371094348756 expected = -4
        TestCaseTwoArgs{lhs: 136471541660537, rhs: 82786158595192, expected: 1},
        TestCaseTwoArgs{lhs: 0b100101111111000011000010000001110100110100000110, rhs: 0b110001000100010010100001000010010101000000011110, expected: 1}, // lhs = -114414673507066 rhs = -65675938148322
        TestCaseTwoArgs{lhs: 79407512790532, rhs: 0b100011100000101010100100001101110110000010100110, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -125298620800858 expected = -1
        TestCaseTwoArgs{lhs: 57745796766899, rhs: 106312064002451, expected: 0},
        TestCaseTwoArgs{lhs: 47734813198872, rhs: 23075944258799, expected: 2},
        TestCaseTwoArgs{lhs: 66098427637498, rhs: 0b111001111110011111100111000110010000010100001101, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -26491776072435 expected = -3
        TestCaseTwoArgs{lhs: 0b101011111100110010111111100010010001001101010110, rhs: 0b100001001111110100000000100011000101100010110011, expected: 0}, // lhs = -88181055089834 rhs = -135252805920589
        TestCaseTwoArgs{lhs: 53272554486596, rhs: 125275737932484, expected: 0},
        TestCaseTwoArgs{lhs: 23480727392650, rhs: 0b100110100011110000000110111000010101110011110100, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -111892372562700 expected = -1
        TestCaseTwoArgs{lhs: 0b100101000110000110011110010111100100101001111001, rhs: 101970070309909, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -118327986992519 expected = -2
        TestCaseTwoArgs{lhs: 0b100111110111011100000011110111011000110011111101, rhs: 82663341157160, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -106141461934851 expected = -2
        TestCaseTwoArgs{lhs: 0b110000100000011101011111000010100111001111101010, rhs: 0b100111111010001010010000101011110110010000101111, expected: 0}, // lhs = -68138061630486 rhs = -105954415778769
        TestCaseTwoArgs{lhs: 0b111011111000011110001100011000100101101100111110, rhs: 0b101000011100101111001000111010111000011110111010, expected: 0}, // lhs = -18109521831106 rhs = -103578355398726
        TestCaseTwoArgs{lhs: 0b100100111100011110110000000100111011111100010101, rhs: 25624160550549, expected: 0b111111111111111111111111111111111111111111111011}, // lhs = -118989114851563 expected = -5
        TestCaseTwoArgs{lhs: 51727415672463, rhs: 54319069163306, expected: 0},
        TestCaseTwoArgs{lhs: 0b101000101011111101011100110110101001010011110111, rhs: 0b111011110001110000100010010110110010000011011110, expected: 5}, // lhs = -102532196428553 rhs = -18570862190370
        TestCaseTwoArgs{lhs: 61398825965244, rhs: 65491811072654, expected: 0},
        TestCaseTwoArgs{lhs: 0b111101001101101010000100111011000100101000000111, rhs: 67117088029181, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -12255606584825 expected = -1
        TestCaseTwoArgs{lhs: 0b110100110110100101110011100001011101100011110001, rhs: 51399833331900, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -49025113532175 expected = -1
        TestCaseTwoArgs{lhs: 16932529299142, rhs: 0b111010000101001101110100110110100001110111110101, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -26029836329483 expected = -1
        TestCaseTwoArgs{lhs: 0b111111010010111110100101101111001010000110101000, rhs: 0b110000011001100010010101011101110000010010000110, expected: 0}, // lhs = -3093890817624 rhs = -68613889915770
        TestCaseTwoArgs{lhs: 0b111001100001001001110011111110011001001001111000, rhs: 0b110011011100111001110000010111000000010010111001, expected: 0}, // lhs = -28508047175048 rhs = -55188444674887
        TestCaseTwoArgs{lhs: 37496346241989, rhs: 115717883447983, expected: 0},
        TestCaseTwoArgs{lhs: 0b110111100110111111001011001001111101011100011000, rhs: 11698248191199, expected: 0b111111111111111111111111111111111111111111111100}, // lhs = -36903245588712 expected = -4
        TestCaseTwoArgs{lhs: 0b111111100010001111011110110101001010001100111010, rhs: 65997028014856, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -2044960922822 expected = -1
        TestCaseTwoArgs{lhs: 114971669308838, rhs: 88302548711818, expected: 1},
        TestCaseTwoArgs{lhs: 114383911397465, rhs: 0b100110101101010000011000111010101101111001100011, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -111239234920861 expected = -2
        TestCaseTwoArgs{lhs: 133148434603701, rhs: 48104141509532, expected: 2},
        TestCaseTwoArgs{lhs: 0b100000010010000000000011010100001011101101000100, rhs: 0b111110000110010000010111100101010110111111011011, expected: 16}, // lhs = -139500482151612 rhs = -8366200623141
        TestCaseTwoArgs{lhs: 0b101100010000111101100000100010101101101110001100, rhs: 0b101100011111001110101100111101111000000000110011, expected: 1}, // lhs = -86795374371956 rhs = -85814839640013
        TestCaseTwoArgs{lhs: 0b111101011011110110010001111010101000010000011011, rhs: 14603607624145, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -11280431021029 expected = -1
        TestCaseTwoArgs{lhs: 0b111100000011001011100000100100100010100101110110, rhs: 116527259695511, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -17373670004362 expected = -1
        TestCaseTwoArgs{lhs: 0b101101010011101010001001110101001001111111011100, rhs: 0b111100100100001100000001111000110101101001001110, expected: 5}, // lhs = -82211951566884 rhs = -15105368303026
        TestCaseTwoArgs{lhs: 110559215797540, rhs: 36825540812714, expected: 3},
        TestCaseTwoArgs{lhs: 0b110100110000001011010100000010100000111111000100, rhs: 92333108153152, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -49465875886140 expected = -1
        TestCaseTwoArgs{lhs: 18554025215714, rhs: 0b110001100110010011100000100011010010101110000001, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -63338410333311 expected = -1
        TestCaseTwoArgs{lhs: 0b110100110100001101001000000001100000111110100010, rhs: 0b111110011010110010101110011001110110011011000101, expected: 7}, // lhs = -49189052084318 rhs = -6954921007419
        TestCaseTwoArgs{lhs: 29647804665287, rhs: 103956437947641, expected: 0},
        TestCaseTwoArgs{lhs: 110559166838052, rhs: 67755282688585, expected: 1},
        TestCaseTwoArgs{lhs: 40135719426219, rhs: 0b110100011100100000111000111100000111001010010010, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -50817097764206 expected = -1
        TestCaseTwoArgs{lhs: 44410903844317, rhs: 80609300486690, expected: 0},
        TestCaseTwoArgs{lhs: 113761599020446, rhs: 0b110111111000111010111011111110001010100101001110, expected: 0b111111111111111111111111111111111111111111111100}, // rhs = -35670844724914 expected = -4
        TestCaseTwoArgs{lhs: 0b110100100010100111101001001111111111111100001111, rhs: 4455715759462, expected: 0b111111111111111111111111111111111111111111110100}, // lhs = -50397527933169 expected = -12
        TestCaseTwoArgs{lhs: 0b101101011111011111000001000101010100010101110000, rhs: 0b101110000001110000100110011011001111001111011101, expected: 1}, // lhs = -81399275764368 rhs = -79043933441059
        TestCaseTwoArgs{lhs: 115300766161866, rhs: 0b100100001010101100100100001110110100111111101011, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -122410255036437 expected = -1
        TestCaseTwoArgs{lhs: 0b110000101011110101000111111100100110010000000100, rhs: 74148614085038, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -67356765035516 expected = -1
        TestCaseTwoArgs{lhs: 128088708709062, rhs: 0b110010000100000010110011100111000101010110111010, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -61294759881286 expected = -3
        TestCaseTwoArgs{lhs: 10340792958114, rhs: 135722676445206, expected: 0},
        TestCaseTwoArgs{lhs: 0b110000110110110111101000101101000111111000010101, rhs: 90122894725595, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -66598153716203 expected = -1
        TestCaseTwoArgs{lhs: 0b101011001000000101100111011000100101111111010011, rhs: 21054271086004, expected: 0b111111111111111111111111111111111111111111111011}, // lhs = -91803191451693 expected = -5
        TestCaseTwoArgs{lhs: 0b101010111010101101101010001010010111001101001010, rhs: 0b101111110010110110100001110101010010111001001001, expected: 1}, // lhs = -92722267851958 rhs = -71272267174327
        TestCaseTwoArgs{lhs: 0b111001001110100110100101111110110011001000010001, rhs: 0b111111001100110010110000011001000100000001100110, expected: 8}, // lhs = -29782813494767 rhs = -3518913822618
        TestCaseTwoArgs{lhs: 0b111100110001001001010111011100100101001001101111, rhs: 57742175275875, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -14214874639761 expected = -1
        TestCaseTwoArgs{lhs: 98775872343464, rhs: 0b101010000111001111011010111101010101100010101111, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -96259428493137 expected = -2
        TestCaseTwoArgs{lhs: 54682148997811, rhs: 7281997623195, expected: 7},
        TestCaseTwoArgs{lhs: 76435000116879, rhs: 118883500683196, expected: 0},
        TestCaseTwoArgs{lhs: 0b100011110000100001011001111111110010010101111100, rhs: 16478376172621, expected: 0b111111111111111111111111111111111111111111111000}, // lhs = -124208944306820 expected = -8
        TestCaseTwoArgs{lhs: 0b111101101011110110010111111111010010011111101011, rhs: 63276489624171, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -10180817508373 expected = -1
        TestCaseTwoArgs{lhs: 0b111010000101010100010100100001110001010110101010, rhs: 0b101100100000110010101101000110110101110000001001, expected: 0}, // lhs = -26022862449238 rhs = -85707463107575
        TestCaseTwoArgs{lhs: 73042603157556, rhs: 104019800887430, expected: 0},
        TestCaseTwoArgs{lhs: 0b101000010011100101011010010011001100000101101010, rhs: 104989820280950, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -104207276523158 expected = -1
        TestCaseTwoArgs{lhs: 0b101101000010000011100100011010110100101011000001, rhs: 0b101011011000100000010000001000011101000101011010, expected: 0}, // lhs = -83421612520767 rhs = -90675078901414
        TestCaseTwoArgs{lhs: 120648533830749, rhs: 14272155963983, expected: 8},
        TestCaseTwoArgs{lhs: 30421996976431, rhs: 0b110010001011101010001100011101010111001010100110, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -60771430731098 expected = -1
        TestCaseTwoArgs{lhs: 13506336830951, rhs: 0b110000100100111101100110110010000111011100111010, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -67828694091974 expected = -1
        TestCaseTwoArgs{lhs: 64517162564602, rhs: 0b100010001000011010100011011111100011001111001000, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -131363126758456 expected = -1
        TestCaseTwoArgs{lhs: 135510909702270, rhs: 61304483768003, expected: 2},
        TestCaseTwoArgs{lhs: 5555575631687, rhs: 0b110101010101011110111110001001011010111010001100, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -46902147699060 expected = -1
        TestCaseTwoArgs{lhs: 0b100011110011001101011011011110010000001011010100, rhs: 0b110101111011110101010011111000010111110011101110, expected: 2}, // lhs = -124024235949356 rhs = -44266820633362
        TestCaseTwoArgs{lhs: 0b111101111010010011000110101001000000011010100110, rhs: 0b101001001001110111111011001010101000010110011001, expected: 0}, // lhs = -9187897375066 rhs = -100476546021991
        TestCaseTwoArgs{lhs: 35880451620605, rhs: 109868860736393, expected: 0},
        TestCaseTwoArgs{lhs: 0b101100010100100011101111001000010000010011010111, rhs: 96634498285414, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -86548169030441 expected = -1
        TestCaseTwoArgs{lhs: 2009795106041, rhs: 119152669009806, expected: 0},
        TestCaseTwoArgs{lhs: 0b100111001100110010000000000001100100001110010100, rhs: 0b101111011010111010010000011110101010010000100000, expected: 1}, // lhs = -109072841555052 rhs = -72917530794976
        TestCaseTwoArgs{lhs: 0b110011000100011011110111111101001010011110100101, rhs: 0b101000100101011101000111100011001111100111010110, expected: 0}, // lhs = -56869796927579 rhs = -102979230434858
        TestCaseTwoArgs{lhs: 18980299531265, rhs: 67134752228859, expected: 0},
        TestCaseTwoArgs{lhs: 43456567463138, rhs: 0b111011100001111111011011000011011011001011100100, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -19654390205724 expected = -3
        TestCaseTwoArgs{lhs: 0b110111110010100010011110101100101111010000010011, rhs: 0b110101000111010110001111111110010001111110000011, expected: 0}, // lhs = -36109422496749 rhs = -47873584980093
        TestCaseTwoArgs{lhs: 130655596662925, rhs: 135607184780113, expected: 0},
        TestCaseTwoArgs{lhs: 0b101111111111001111101000001101001110111001001010, rhs: 89255706258706, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -70420682969526 expected = -1
        TestCaseTwoArgs{lhs: 83117834831388, rhs: 0b101010001111010001001011001110110001010111011101, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -95707789060643 expected = -1
        TestCaseTwoArgs{lhs: 36020981282988, rhs: 119008503419967, expected: 0},
        TestCaseTwoArgs{lhs: 109035253155288, rhs: 0b101110110100110111111001001001000001010100001001, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -75531409943287 expected = -2
        TestCaseTwoArgs{lhs: 0b111011010111101000110111011001011010000010101000, rhs: 0b111111000111111011101010101010010011100010010110, expected: 5}, // lhs = -20365805510488 rhs = -3852943673194
        TestCaseTwoArgs{lhs: 0b101110011100111111110111101101101010011010110000, rhs: 0b100011100010100111011111010010001010110010101110, expected: 0}, // lhs = -77172111399248 rhs = -125164485825362
        TestCaseTwoArgs{lhs: 0b110100010110111101101010100010101010011010001001, rhs: 133645471742290, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -51198517664119 expected = -1
        TestCaseTwoArgs{lhs: 93751336479353, rhs: 0b111101110000110100111100110111110110010001110111, expected: 0b111111111111111111111111111111111111111111110110}, // rhs = -9838748801929 expected = -10
        TestCaseTwoArgs{lhs: 0b100111101000110010011010010100111001110001011000, rhs: 0b100110100001100110011110000010001000001111100001, expected: 0}, // lhs = -107148254929832 rhs = -112040160492575
        TestCaseTwoArgs{lhs: 86612432210772, rhs: 133574444026950, expected: 0},
        TestCaseTwoArgs{lhs: 125770739358190, rhs: 0b100111110010110110110100100001011001000001001110, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -106456325713842 expected = -2
        TestCaseTwoArgs{lhs: 121776072884478, rhs: 0b110111110011101010100001100001000101111000000011, expected: 0b111111111111111111111111111111111111111111111100}, // rhs = -36032065806845 expected = -4
        TestCaseTwoArgs{lhs: 0b110000100111100001100001111000000100001010010000, rhs: 0b101111111110111011110100110000000111000111110010, expected: 0}, // lhs = -67652682759536 rhs = -70441947336206
        TestCaseTwoArgs{lhs: 70201460099186, rhs: 0b111110111010000111100010100011110111101010001101, expected: 0b111111111111111111111111111111111111111111110001}, // rhs = -4802267350387 expected = -15
        TestCaseTwoArgs{lhs: 94257812796604, rhs: 0b101010101111101001000010010000110000011001100111, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -93483146475929 expected = -2
        TestCaseTwoArgs{lhs: 105155960624272, rhs: 0b111001110110000111001011001011101100100110111010, expected: 0b111111111111111111111111111111111111111111111100}, // rhs = -27067770025542 expected = -4
        TestCaseTwoArgs{lhs: 0b101000000001010101000011101101110110010001101000, rhs: 0b111110101011001101101101000100011110110111101110, expected: 18}, // lhs = -105461785861016 rhs = -5826440729106
        TestCaseTwoArgs{lhs: 89585503840499, rhs: 71131488627812, expected: 1},
        TestCaseTwoArgs{lhs: 62444293264783, rhs: 0b100111110011000101000100011001010000111110000101, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -106441027022971 expected = -1
        TestCaseTwoArgs{lhs: 0b100011011111011111001011011111110001100001111101, rhs: 0b100000000110110101001000111111111100111110100100, expected: 0}, // lhs = -125379566167939 rhs = -140268112195676
        TestCaseTwoArgs{lhs: 124465656032980, rhs: 90596093585169, expected: 1},
        TestCaseTwoArgs{lhs: 5771829472782, rhs: 0b111110011011101000001100101111101110000111101101, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -6897503641107 expected = -1
        TestCaseTwoArgs{lhs: 98332478061627, rhs: 0b100000010000100011101100101100110110100101000001, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -139599645808319 expected = -1
        TestCaseTwoArgs{lhs: 0b100011111100010000010010000001111001110000011010, rhs: 89050924962997, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -123402697860070 expected = -2
        TestCaseTwoArgs{lhs: 73068662633096, rhs: 125916479556752, expected: 0},
        TestCaseTwoArgs{lhs: 36735993046812, rhs: 0b100011000000111011110011110101101111111111000001, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -127479128326207 expected = -1
        TestCaseTwoArgs{lhs: 0b111110101111000011111100010101110010011101110110, rhs: 75297074181476, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -5562044045450 expected = -1
        TestCaseTwoArgs{lhs: 34015949409372, rhs: 1606568660455, expected: 21},
        TestCaseTwoArgs{lhs: 0b110100100101101011111001101110011011110001111101, rhs: 37535449080053, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -50186798121859 expected = -2
        TestCaseTwoArgs{lhs: 9437660762347, rhs: 0b100011000110000101011101010010110110110001001100, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -127125171770292 expected = -1
        TestCaseTwoArgs{lhs: 0b100101101011001000111001000000101010001100101000, rhs: 0b111000001111001001100001011110001011100111111101, expected: 3}, // lhs = -115782771891416 rhs = -34143354701315
        TestCaseTwoArgs{lhs: 82355516374106, rhs: 0b110010110001101101100011001101010100110000001110, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -58156487717874 expected = -2
        TestCaseTwoArgs{lhs: 0b101101000010110000010001100001100111000111011010, rhs: 0b101011101001000000101111011111110010011010100011, expected: 0}, // lhs = -83373611126310 rhs = -89540681324893
        TestCaseTwoArgs{lhs: 119669247882151, rhs: 90275547597224, expected: 1},
        TestCaseTwoArgs{lhs: 88685808034760, rhs: 123658074542427, expected: 0},
        TestCaseTwoArgs{lhs: 0b111000011110001000010001100101010001110111001110, rhs: 19225740322583, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -33113902866994 expected = -2
        TestCaseTwoArgs{lhs: 113480333223306, rhs: 0b110011111110101110101100011110110001101111011101, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -52863858697251 expected = -3
        TestCaseTwoArgs{lhs: 103035537255529, rhs: 0b101110011001110010110101000101101011000100010011, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -77392272510701 expected = -2
        TestCaseTwoArgs{lhs: 22327784512782, rhs: 0b101001110101110100101101010011011001101010110011, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -97456342852941 expected = -1
        TestCaseTwoArgs{lhs: 8702300223165, rhs: 0b101111101011011001110111111001111010000110001110, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -71784071716466 expected = -1
        TestCaseTwoArgs{lhs: 0b101100100001111011101001001000011001011101110010, rhs: 0b111110000101110100110010000011100101001010110000, expected: 10}, // lhs = -85629146654862 rhs = -8395821264208
        TestCaseTwoArgs{lhs: 0b111110000000011100101100010010110011001011111010, rhs: 0b111010000000100101011010000110000000110010100100, expected: 0}, // lhs = -8765285125382 rhs = -26348112835420
        TestCaseTwoArgs{lhs: 0b101010000101110010000011011101000010110111000001, rhs: 0b111100010111001101001000000101111010000110011110, expected: 6}, // lhs = -96359680823871 rhs = -15997543669346
        TestCaseTwoArgs{lhs: 0b100011000110110001010000001000101100110111001011, rhs: 0b100101000010100010010101011001101111110101111011, expected: 1}, // lhs = -127078147895861 rhs = -118572950553221
        TestCaseTwoArgs{lhs: 0b100001001101011111111100100100110101100100011001, rhs: 0b111101100100101001011101110011001011000100101101, expected: 12}, // lhs = -135411786360551 rhs = -10675715002067
        TestCaseTwoArgs{lhs: 104597322080512, rhs: 0b101011000110101010100010101001010010111001101011, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -91900981465493 expected = -2
        TestCaseTwoArgs{lhs: 14549014469839, rhs: 126183113001986, expected: 0},
        TestCaseTwoArgs{lhs: 0b111010010110110110010011111000000011110011110111, rhs: 28696272006174, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -24818135057161 expected = -1
        TestCaseTwoArgs{lhs: 0b110110010101000010011101100000110000000111111101, rhs: 59054118518937, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -42534713490947 expected = -1
        TestCaseTwoArgs{lhs: 105981333946700, rhs: 0b111000111110011100100001101001000001001111001010, expected: 0b111111111111111111111111111111111111111111111100}, // rhs = -30893135359030 expected = -4
        TestCaseTwoArgs{lhs: 6576359127334, rhs: 0b110010000101011111011010100011110101001110110111, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -61195322174537 expected = -1
        TestCaseTwoArgs{lhs: 121147218011305, rhs: 853610565518, expected: 141},
        TestCaseTwoArgs{lhs: 0b111000001100010111101110001111001110111000011000, rhs: 109676535249259, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -34334266561000 expected = -1
        TestCaseTwoArgs{lhs: 0b101101101111110001100111111000011101111111110111, rhs: 0b101111100000000011101011001000011001001001000110, expected: 1}, // lhs = -80279785840649 rhs = -72563822587322
        TestCaseTwoArgs{lhs: 62934280421374, rhs: 0b100001010110001011111001100101010011111000010000, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -134814836113904 expected = -1
        TestCaseTwoArgs{lhs: 103027166190598, rhs: 0b110100101000010101011100011000001011010110101111, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -50004754385489 expected = -3
        TestCaseTwoArgs{lhs: 108703242751353, rhs: 83477729264032, expected: 1},
        TestCaseTwoArgs{lhs: 114897136452774, rhs: 67175836585492, expected: 1},
        TestCaseTwoArgs{lhs: 0b110100000100011101110011100010111011000110011001, rhs: 0b100010100001001111111010111110111111001000001011, expected: 0}, // lhs = -52469676920423 rhs = -129656556883445
        TestCaseTwoArgs{lhs: 0b100000010001010101001111100010110100001000000000, rhs: 0b100001110111111011010010100011010110100000110100, expected: 1}, // lhs = -139546447887872 rhs = -132496208598988
        TestCaseTwoArgs{lhs: 36909583768444, rhs: 110569129724500, expected: 0},
        TestCaseTwoArgs{lhs: 49651085990471, rhs: 0b110101100100110001010101000101011110111111001000, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -45851643351096 expected = -2
        TestCaseTwoArgs{lhs: 136332584933905, rhs: 137029962470896, expected: 0},
        TestCaseTwoArgs{lhs: 67152098623430, rhs: 99683731993595, expected: 0},
        TestCaseTwoArgs{lhs: 0b110010001100110000111110111011010100100111111000, rhs: 10923745514724, expected: 0b111111111111111111111111111111111111111111111010}, // lhs = -60695422088712 expected = -6
        TestCaseTwoArgs{lhs: 49664872135320, rhs: 0b101001111110111011110001001011011011100111111001, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -96830286349831 expected = -1
        TestCaseTwoArgs{lhs: 103062717775024, rhs: 15948768705860, expected: 6},
        TestCaseTwoArgs{lhs: 0b101000100000000000011010101000110000001011101001, rhs: 75034562226436, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -103353646120215 expected = -2
        TestCaseTwoArgs{lhs: 0b110110001110111101100011110011101001110001011011, rhs: 58732239516169, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -42952293442469 expected = -1
        TestCaseTwoArgs{lhs: 0b100011000101101010101000100101000100010101110010, rhs: 77246218970133, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -127153973475982 expected = -2
        TestCaseTwoArgs{lhs: 21082722072114, rhs: 30039523332659, expected: 0},
        TestCaseTwoArgs{lhs: 94895964501198, rhs: 0b110111101111100110101101010000011101011101000110, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -36311041714362 expected = -3
        TestCaseTwoArgs{lhs: 118622958234212, rhs: 0b110001111011000110000101010100011000100111101111, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -61909716858385 expected = -2
        TestCaseTwoArgs{lhs: 121080207499933, rhs: 85473510512903, expected: 1},
        TestCaseTwoArgs{lhs: 129489924470173, rhs: 124237136838704, expected: 1},
        TestCaseTwoArgs{lhs: 0b100010000001111101011010010011100000101011111001, rhs: 112836568268303, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -131806736282887 expected = -2
        TestCaseTwoArgs{lhs: 139575311634675, rhs: 0b110001110101010101100110000111011000011100111010, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -62305377351878 expected = -3
        TestCaseTwoArgs{lhs: 0b111111010100000111100010001100001110001101010111, rhs: 1304447833382, expected: 0b111111111111111111111111111111111111111111111101}, // lhs = -3015567154345 expected = -3
        TestCaseTwoArgs{lhs: 0b110010101011100110000111010101010001100111001111, rhs: 0b111001011110001101011000110000001011110110111000, expected: 2}, // lhs = -58576788448817 rhs = -28710367347272
        TestCaseTwoArgs{lhs: 111321914724479, rhs: 126463094868611, expected: 0},
        TestCaseTwoArgs{lhs: 98387208417286, rhs: 11273387599022, expected: 8},
        TestCaseTwoArgs{lhs: 14748432006114, rhs: 73919822350720, expected: 0},
        TestCaseTwoArgs{lhs: 100224324891642, rhs: 37733069060008, expected: 2},
        TestCaseTwoArgs{lhs: 0b101011101010010001111011000000011111011111010011, rhs: 22102493401772, expected: 0b111111111111111111111111111111111111111111111011}, // lhs = -89453515114541 expected = -5
        TestCaseTwoArgs{lhs: 0b100010001010101001111100101111111010001001011001, rhs: 0b101100101110110111011010011000010011100001111010, expected: 1}, // lhs = -131209157959079 rhs = -84740335912838
        TestCaseTwoArgs{lhs: 0b111111110100111011001110100010011110001000000001, rhs: 32166397083103, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -761039035903 expected = -1
        TestCaseTwoArgs{lhs: 0b111010100101001011011000000000011011100100001100, rhs: 74720410507719, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -23833444501236 expected = -1
        TestCaseTwoArgs{lhs: 14858437616259, rhs: 104381816567855, expected: 0},
        TestCaseTwoArgs{lhs: 0b111000111011001000110101010010110110101100101101, rhs: 0b110100000001000010100101110011110100110110001001, expected: 0}, // lhs = -31120438891731 rhs = -52705056830071
        TestCaseTwoArgs{lhs: 0b111110000111000110001111010001001010101100001011, rhs: 14176471943100, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -8308358075637 expected = -1
        TestCaseTwoArgs{lhs: 7314794372834, rhs: 0b101110110101001100000010001001101010011011111110, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -75509783943426 expected = -1
        TestCaseTwoArgs{lhs: 89532523639485, rhs: 0b101100100111010001101001111011011110001010011001, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -85261913562471 expected = -2
        TestCaseTwoArgs{lhs: 58552022182001, rhs: 14701468499606, expected: 3},
        TestCaseTwoArgs{lhs: 40499734963316, rhs: 125201823421530, expected: 0},
        TestCaseTwoArgs{lhs: 0b101010010001011101001100000000111010001011110011, rhs: 60953963931706, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -95557452061965 expected = -2
        TestCaseTwoArgs{lhs: 11157613218370, rhs: 102839368492073, expected: 0},
        TestCaseTwoArgs{lhs: 81177634515044, rhs: 86478087749002, expected: 0},
        TestCaseTwoArgs{lhs: 140182840667779, rhs: 26820710998036, expected: 5},
        TestCaseTwoArgs{lhs: 96902459452505, rhs: 0b101001001011111011100111011000001100001010111000, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -100335144090952 expected = -1
        TestCaseTwoArgs{lhs: 0b111001010011011101011110100111011010100101101110, rhs: 0b101100101001100110010100101000101000111000111010, expected: 0}, // lhs = -29449003357842 rhs = -85102283289030
        TestCaseTwoArgs{lhs: 74358766420069, rhs: 0b100110100110001111101110011111010110010110100001, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -111720983075423 expected = -1
        TestCaseTwoArgs{lhs: 87678677015430, rhs: 34680404593432, expected: 2},
        TestCaseTwoArgs{lhs: 0b111001010111101111000111111110100111010011001000, rhs: 0b101111101010001110010001111000010111101010110111, expected: 0}, // lhs = -29155177892664 rhs = -71865240290633
        TestCaseTwoArgs{lhs: 0b110101010110101110011110000101011000001001100001, rhs: 99469739849630, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -46816786283935 expected = -1
        TestCaseTwoArgs{lhs: 0b100001000110111000110010001101100011000110001101, rhs: 20828750377289, expected: 0b111111111111111111111111111111111111111111111001}, // lhs = -135866153029235 expected = -7
        TestCaseTwoArgs{lhs: 59863019054575, rhs: 0b101111110011111011000000010110011011101101100100, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -71198740726940 expected = -1
        TestCaseTwoArgs{lhs: 112564754881828, rhs: 0b100000001000000010110000100101000000011111001010, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -140184770050102 expected = -1
        TestCaseTwoArgs{lhs: 89613880400037, rhs: 121102835710732, expected: 0},
        TestCaseTwoArgs{lhs: 0b110100011000001100110111010110111111111100011010, rhs: 99851324585205, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -51113477013734 expected = -1
        TestCaseTwoArgs{lhs: 0b110101111010001011001000010100111111001110101000, rhs: 140012800247187, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -44380831091800 expected = -1
        TestCaseTwoArgs{lhs: 84222417426594, rhs: 0b101001010100101111101110101000001101001101000101, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -99729432063163 expected = -1
        TestCaseTwoArgs{lhs: 61813580836341, rhs: 12596151679927, expected: 4},
        TestCaseTwoArgs{lhs: 4211117391448, rhs: 118417152926049, expected: 0},
        TestCaseTwoArgs{lhs: 0b101011110001111011100111001110110100011111101100, rhs: 0b100110010111100010001000111010100000001000001110, expected: 0}, // lhs = -88927713409044 rhs = -112732004548082
        TestCaseTwoArgs{lhs: 0b101011001111100100111101111110010011111101010111, rhs: 0b110100101111100011100100010001010100001010100100, expected: 1}, // lhs = -91288490131625 rhs = -49508553243996
        TestCaseTwoArgs{lhs: 138446890909616, rhs: 117880846457858, expected: 1},
        TestCaseTwoArgs{lhs: 0b101100010000011100010111100010100101100000100100, rhs: 0b110111001011111011100011111101011000110111001111, expected: 2}, // lhs = -86830958880732 rhs = -38762550293041
        TestCaseTwoArgs{lhs: 40556514522260, rhs: 0b111111101110011001000100011101111111001010101010, expected: 0b111111111111111111111111111111111111111111011110}, // rhs = -1210032065878 expected = -34
        TestCaseTwoArgs{lhs: 0b110000111110001111001101001100010000100001111011, rhs: 0b111010000001100000100101111000000110111000010111, expected: 2}, // lhs = -66091809175429 rhs = -26284564386281
        TestCaseTwoArgs{lhs: 0b101100100010010000101000011110101110100010110011, rhs: 100300840438690, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -85606609000269 expected = -1
        TestCaseTwoArgs{lhs: 0b100010000100001110000011100101010100000011000000, rhs: 0b100001001010010011110010100010101100010001110101, expected: 0}, // lhs = -131651424927552 rhs = -135630998027147
        TestCaseTwoArgs{lhs: 110835174565123, rhs: 0b110010011100001100000111100101001010101000011111, expected: 0b111111111111111111111111111111111111111111111110}, // rhs = -59635493721569 expected = -2
        TestCaseTwoArgs{lhs: 124091181046677, rhs: 52374864436317, expected: 2},
        TestCaseTwoArgs{lhs: 0b111000111100110010000011010011110100100100001100, rhs: 133313910816720, expected: 0b111111111111111111111111111111111111111111111111}, // lhs = -31007460865780 expected = -1
        TestCaseTwoArgs{lhs: 58810543863624, rhs: 135688326897743, expected: 0},
        TestCaseTwoArgs{lhs: 0b110000000100100010000111101101111010110010010111, rhs: 43567564636713, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -70057229570921 expected = -2
        TestCaseTwoArgs{lhs: 104147774816422, rhs: 128535721477300, expected: 0},
        TestCaseTwoArgs{lhs: 120708021851502, rhs: 0b110011011101011000101110011010000000001101000110, expected: 0b111111111111111111111111111111111111111111111101}, // rhs = -55155191446714 expected = -3
        TestCaseTwoArgs{lhs: 0b101000001110011011011000110000010111111110100000, rhs: 0b110110011000000010010100101000000101010011010001, expected: 2}, // lhs = -104561637228640 rhs = -42328704133935
        TestCaseTwoArgs{lhs: 5104884627568, rhs: 89649870444066, expected: 0},
        TestCaseTwoArgs{lhs: 0b101110101101100110110000000100001101010010101001, rhs: 0b101110111001010010001010000101001101011000010100, expected: 1}, // lhs = -76030852148055 rhs = -75228330535404
        TestCaseTwoArgs{lhs: 49380454956647, rhs: 24697190745213, expected: 1},
        TestCaseTwoArgs{lhs: 13589790547564, rhs: 86365032935930, expected: 0},
        TestCaseTwoArgs{lhs: 64598872222216, rhs: 0b111100111011000010101100100110111010111010011011, expected: 0b111111111111111111111111111111111111111111111011}, // rhs = -13534841033061 expected = -5

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 0b100000000000000000000000000000000000000000000000, expected: 0}, // rhs = -140737488355328
        TestCaseTwoArgs{lhs: 0b100000000000000000000000000000000000000000000000, rhs: 0b100000000000000000000000000000000000000000000000, expected: 1}, // lhs = -140737488355328 rhs = -140737488355328
        TestCaseTwoArgs{lhs: 140737488355327, rhs: 140737488355327, expected: 1},
        TestCaseTwoArgs{lhs: 140737488355327, rhs: 0b100000000000000000000000000000000000000000000000, expected: 0b111111111111111111111111111111111111111111111111}, // rhs = -140737488355328 expected = -1
        TestCaseTwoArgs{lhs: 0b100000000000000000000000000000000000000000000000, rhs: 140737488355327, expected: 0b111111111111111111111111111111111111111111111110}, // lhs = -140737488355328 expected = -2
        TestCaseTwoArgs{lhs: 0, rhs: 140737488355327, expected: 0},
    ];

    #[test]
    fn test_i48() {
        for case in test_cases.span() {
            assert_eq!(__llvm_sdiv_k_k_k(*case.lhs, *case.rhs), *case.expected);
        }
    }

    #[test]
    #[should_panic(expected: ('Division by 0',))]
    fn test_div_by_zero() {
        __llvm_sdiv_k_k_k(1, 0);
    }
}
