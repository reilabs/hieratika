use crate::alu::ssub_sat::ssub_sat;

pub fn __llvm_ssub_sat_i_i_i(lhs: u128, rhs: u128) -> u128 {
    ssub_sat::<u32>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use super::__llvm_ssub_sat_i_i_i;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 129] = [
        // Due to Cairo's casting limitation, negative numbers are represented as bit patterns.

        // Random test cases
        TestCaseTwoArgs{lhs: 0b11110001111110001101001100100000, rhs: 0b11100010010100111101110110101111, expected: 262468977}, // lhs = -235351264 rhs = -497820241
        TestCaseTwoArgs{lhs: 1384125504, rhs: 0b11011001011001110000101001001101, expected: 2031684083}, // rhs = -647558579
        TestCaseTwoArgs{lhs: 0b10011011111101101011110000100110, rhs: 1031564958, expected: 2147483648}, // lhs = -1678328794
        TestCaseTwoArgs{lhs: 1357277921, rhs: 0b11110000001101100100101001010001, expected: 1622155408}, // rhs = -264877487
        TestCaseTwoArgs{lhs: 638547458, rhs: 566978057, expected: 71569401},
        TestCaseTwoArgs{lhs: 1894931333, rhs: 2035150270, expected: 4154748359},
        TestCaseTwoArgs{lhs: 1679351945, rhs: 989376710, expected: 689975235},
        TestCaseTwoArgs{lhs: 82646299, rhs: 987295525, expected: 3390318070},
        TestCaseTwoArgs{lhs: 1724076252, rhs: 0b11111100100111001011101010110100, expected: 1780913704}, // rhs = -56837452
        TestCaseTwoArgs{lhs: 439107042, rhs: 475968645, expected: 4258105693},
        TestCaseTwoArgs{lhs: 395947692, rhs: 1540452264, expected: 3150462724},
        TestCaseTwoArgs{lhs: 0b11101111010001100010100101010000, rhs: 1085156722, expected: 2929195998}, // lhs = -280614576
        TestCaseTwoArgs{lhs: 0b10010010111001000010110110011011, rhs: 0b11001001001000110001111101000001, expected: 3384872538}, // lhs = -1830539877 rhs = -920445119
        TestCaseTwoArgs{lhs: 0b10100100111000100011011011000010, rhs: 1479302689, expected: 2147483648}, // lhs = -1528678718
        TestCaseTwoArgs{lhs: 640622721, rhs: 0b11011011110111100100001111111110, expected: 1246813315}, // rhs = -606190594
        TestCaseTwoArgs{lhs: 0b10000101011101011111011000100100, rhs: 764810556, expected: 2147483648}, // lhs = -2055866844
        TestCaseTwoArgs{lhs: 1752022497, rhs: 539969584, expected: 1212052913},
        TestCaseTwoArgs{lhs: 1373436287, rhs: 1157277102, expected: 216159185},
        TestCaseTwoArgs{lhs: 152054104, rhs: 0b11000011010001110111011010010101, expected: 1170780867}, // rhs = -1018726763
        TestCaseTwoArgs{lhs: 0b11110011100110011011111000111101, rhs: 0b11100111100000001101110000001011, expected: 202957362}, // lhs = -208028099 rhs = -410985461
        TestCaseTwoArgs{lhs: 0b10011010111110110101000111010111, rhs: 0b10100010111111001011011100011000, expected: 4160658111}, // lhs = -1694805545 rhs = -1560496360
        TestCaseTwoArgs{lhs: 1183369732, rhs: 0b11011011000001000111100010111111, expected: 1803833669}, // rhs = -620463937
        TestCaseTwoArgs{lhs: 1622515947, rhs: 1471615292, expected: 150900655},
        TestCaseTwoArgs{lhs: 439835266, rhs: 488293964, expected: 4246508598},
        TestCaseTwoArgs{lhs: 0b11011110110010110011111000101101, rhs: 1508130659, expected: 2229731018}, // lhs = -557105619
        TestCaseTwoArgs{lhs: 1715730701, rhs: 584383933, expected: 1131346768},
        TestCaseTwoArgs{lhs: 0b10100000011000101100001000110011, rhs: 37640014, expected: 2653186789}, // lhs = -1604140493
        TestCaseTwoArgs{lhs: 0b11110100110001000011010100001010, rhs: 0b10000000010100110111100100101011, expected: 1953545183}, // lhs = -188467958 rhs = -2142013141
        TestCaseTwoArgs{lhs: 1188457184, rhs: 0b10011010010111001101010000110110, expected: 2147483647}, // rhs = -1705192394
        TestCaseTwoArgs{lhs: 1815691172, rhs: 874436899, expected: 941254273},
        TestCaseTwoArgs{lhs: 1048837481, rhs: 1987001550, expected: 3356803227},
        TestCaseTwoArgs{lhs: 0b11000010010101111000000001010101, rhs: 0b11011111011001010111010110000101, expected: 3807513296}, // lhs = -1034452907 rhs = -546998907
        TestCaseTwoArgs{lhs: 1542395697, rhs: 0b11011100000100100101101000010000, expected: 2145172769}, // rhs = -602777072
        TestCaseTwoArgs{lhs: 0b10001100011101110000111000111000, rhs: 0b11110111111110001000110110001011, expected: 2491318445}, // lhs = -1938354632 rhs = -134705781
        TestCaseTwoArgs{lhs: 1410194744, rhs: 1942803635, expected: 3762358405},
        TestCaseTwoArgs{lhs: 0b11100000010011011100000010100101, rhs: 893728765, expected: 2869463208}, // lhs = -531775323
        TestCaseTwoArgs{lhs: 0b10000010000110010010110111100111, rhs: 973913229, expected: 2147483648}, // lhs = -2112279065
        TestCaseTwoArgs{lhs: 0b10110110001101011000001001011111, rhs: 1765598126, expected: 2147483648}, // lhs = -1238007201
        TestCaseTwoArgs{lhs: 0b11001001100100111010101110010001, rhs: 0b11111110111000100111000010001010, expected: 3400612615}, // lhs = -913069167 rhs = -18714486
        TestCaseTwoArgs{lhs: 1194263962, rhs: 1269345498, expected: 4219885760},
        TestCaseTwoArgs{lhs: 1614813567, rhs: 0b10010101011011100010111011011110, expected: 2147483647}, // rhs = -1787941154
        TestCaseTwoArgs{lhs: 1467052747, rhs: 1295891662, expected: 171161085},
        TestCaseTwoArgs{lhs: 0b10011001000010100010000111000100, rhs: 0b10010111000010001111101011011011, expected: 33629929}, // lhs = -1727389244 rhs = -1761019173
        TestCaseTwoArgs{lhs: 0b10000111011010001000010111011101, rhs: 429697779, expected: 2147483648}, // lhs = -2023193123
        TestCaseTwoArgs{lhs: 0b10000100101100010011001110001001, rhs: 340909529, expected: 2147483648}, // lhs = -2068761719
        TestCaseTwoArgs{lhs: 0b11101101100101101101001000111100, rhs: 414902515, expected: 3571181897}, // lhs = -308882884
        TestCaseTwoArgs{lhs: 0b10010010011010000111110101101101, rhs: 0b10111101111000010100100001011101, expected: 3565630736}, // lhs = -1838645907 rhs = -1109309347
        TestCaseTwoArgs{lhs: 0b10111000110011001011000010010111, rhs: 0b11101110100101011010011100000101, expected: 3392604562}, // lhs = -1194545001 rhs = -292182267
        TestCaseTwoArgs{lhs: 0b10101010000001001111001110111011, rhs: 1712764088, expected: 2147483648}, // lhs = -1442516037
        TestCaseTwoArgs{lhs: 1669806583, rhs: 346433425, expected: 1323373158},
        TestCaseTwoArgs{lhs: 0b11001001101011000110011100010010, rhs: 0b11100100010111011010110100101110, expected: 3847141860}, // lhs = -911448302 rhs = -463622866
        TestCaseTwoArgs{lhs: 0b11101100101111100010011110011000, rhs: 0b10100011110010000101000100101110, expected: 1224070762}, // lhs = -323082344 rhs = -1547153106
        TestCaseTwoArgs{lhs: 0b10110111010110100111111010011100, rhs: 0b11001001010010100010101001100101, expected: 3994047543}, // lhs = -1218806116 rhs = -917886363
        TestCaseTwoArgs{lhs: 132592722, rhs: 0b10111100111100101110001110001011, expected: 1257525447}, // rhs = -1124932725
        TestCaseTwoArgs{lhs: 0b11100000001110001010011101101101, rhs: 1512058941, expected: 2249750320}, // lhs = -533158035
        TestCaseTwoArgs{lhs: 391447775, rhs: 1212435257, expected: 3473979814},
        TestCaseTwoArgs{lhs: 1954943616, rhs: 1545168154, expected: 409775462},
        TestCaseTwoArgs{lhs: 1825760581, rhs: 0b10111001101111111101000111000011, expected: 2147483647}, // rhs = -1178611261
        TestCaseTwoArgs{lhs: 0b11010000001000000100001011101011, rhs: 0b10101001011011111011110011000011, expected: 649102888}, // lhs = -803192085 rhs = -1452294973
        TestCaseTwoArgs{lhs: 0b11101110101001011011011111011111, rhs: 1674784076, expected: 2329053843}, // lhs = -291129377
        TestCaseTwoArgs{lhs: 0b10011011000011001100010010110001, rhs: 590606467, expected: 2147483648}, // lhs = -1693662031
        TestCaseTwoArgs{lhs: 0b10001010001111000010100010111011, rhs: 0b10110011110101101011100000010111, expected: 3596972196}, // lhs = -1975768901 rhs = -1277773801
        TestCaseTwoArgs{lhs: 0b10011111101110110000110110110100, rhs: 797734823, expected: 2147483648}, // lhs = -1615131212
        TestCaseTwoArgs{lhs: 1256390080, rhs: 0b10000101011000001100010001011110, expected: 2147483647}, // rhs = -2057255842
        TestCaseTwoArgs{lhs: 684336025, rhs: 0b10000011010000110111111010001001, expected: 2147483647}, // rhs = -2092728695
        TestCaseTwoArgs{lhs: 0b10111110010100100111101101111111, rhs: 0b10000101010010000001011011001001, expected: 956982454}, // lhs = -1101890689 rhs = -2058873143
        TestCaseTwoArgs{lhs: 0b11100110011001100110010001010000, rhs: 0b11110001111110101110001100011010, expected: 4100686134}, // lhs = -429497264 rhs = -235216102
        TestCaseTwoArgs{lhs: 558336588, rhs: 0b11110010100110010010101101101110, expected: 783179486}, // rhs = -224842898
        TestCaseTwoArgs{lhs: 1501059850, rhs: 0b11110110001111111111011101111100, expected: 1664639886}, // rhs = -163580036
        TestCaseTwoArgs{lhs: 2060788272, rhs: 0b10100111101000001110101001001100, expected: 2147483647}, // rhs = -1482626484
        TestCaseTwoArgs{lhs: 0b11011011100010111110110011010100, rhs: 345737862, expected: 3337642574}, // lhs = -611586860
        TestCaseTwoArgs{lhs: 0b11101101000011100001001100000100, rhs: 0b10111000000110110010001010111111, expected: 888336453}, // lhs = -317844732 rhs = -1206181185
        TestCaseTwoArgs{lhs: 0b11111010011000001110001010111101, rhs: 0b10001100001101100011110001111100, expected: 1848288833}, // lhs = -94313795 rhs = -1942602628
        TestCaseTwoArgs{lhs: 0b10111111100011011010000000011001, rhs: 0b11011001100110001001011101110011, expected: 3858040998}, // lhs = -1081237479 rhs = -644311181
        TestCaseTwoArgs{lhs: 0b11001111101111000001011011000010, rhs: 131452259, expected: 3353758047}, // lhs = -809756990
        TestCaseTwoArgs{lhs: 1499061434, rhs: 2021603230, expected: 3772425500},
        TestCaseTwoArgs{lhs: 0b10111000111011000100011000100010, rhs: 0b10100001100000101100010000100001, expected: 392790529}, // lhs = -1192475102 rhs = -1585265631
        TestCaseTwoArgs{lhs: 0b10101110101110100110000011011110, rhs: 452832424, expected: 2478617654}, // lhs = -1363517218
        TestCaseTwoArgs{lhs: 1271838347, rhs: 0b11011100000110101101010111000011, expected: 1874059464}, // rhs = -602221117
        TestCaseTwoArgs{lhs: 0b11001000011000001111000000001001, rhs: 860526721, expected: 2501269384}, // lhs = -933171191
        TestCaseTwoArgs{lhs: 578835593, rhs: 1642134406, expected: 3231668483},
        TestCaseTwoArgs{lhs: 526546160, rhs: 269154051, expected: 257392109},
        TestCaseTwoArgs{lhs: 0b11101100011000110000100110010011, rhs: 0b10000001111011110111110101001000, expected: 1785957451}, // lhs = -329053805 rhs = -2115011256
        TestCaseTwoArgs{lhs: 0b10110001011110011011101111011110, rhs: 0b10101110110111011010110111101000, expected: 43781622}, // lhs = -1317422114 rhs = -1361203736
        TestCaseTwoArgs{lhs: 492572952, rhs: 526620666, expected: 4260919582},
        TestCaseTwoArgs{lhs: 534628251, rhs: 0b10110100110001110001110001010000, expected: 1796647755}, // rhs = -1262019504
        TestCaseTwoArgs{lhs: 0b11010011010000000001010111000011, rhs: 0b10100101001110110010111010001001, expected: 772073274}, // lhs = -750774845 rhs = -1522848119
        TestCaseTwoArgs{lhs: 0b11100011011100010011101010100110, rhs: 349499839, expected: 3466348775}, // lhs = -479118682
        TestCaseTwoArgs{lhs: 796584673, rhs: 18648431, expected: 777936242},
        TestCaseTwoArgs{lhs: 732491333, rhs: 841480837, expected: 4185977792},
        TestCaseTwoArgs{lhs: 1119162427, rhs: 0b10011010010010010011111101100011, expected: 2147483647}, // rhs = -1706475677
        TestCaseTwoArgs{lhs: 0b10011111101111000101000000010011, rhs: 0b10100110011010101110000000000100, expected: 4182863887}, // lhs = -1615048685 rhs = -1502945276
        TestCaseTwoArgs{lhs: 1234191887, rhs: 1684229168, expected: 3844930015},
        TestCaseTwoArgs{lhs: 563990884, rhs: 0b11111100010011111011001110000110, expected: 625876446}, // rhs = -61885562
        TestCaseTwoArgs{lhs: 1682508739, rhs: 0b11011101110101011001101111010010, expected: 2147483647}, // rhs = -573203502
        TestCaseTwoArgs{lhs: 871712933, rhs: 290033543, expected: 581679390},
        TestCaseTwoArgs{lhs: 0b10010000111101100100001001111110, rhs: 779568014, expected: 2147483648}, // lhs = -1862909314
        TestCaseTwoArgs{lhs: 1671586663, rhs: 978773717, expected: 692812946},
        TestCaseTwoArgs{lhs: 944609888, rhs: 0b10001100111110000110100110010010, expected: 2147483647}, // rhs = -1929877102
        TestCaseTwoArgs{lhs: 438766466, rhs: 0b10011011011011110110100100010010, expected: 2125963888}, // rhs = -1687197422
        TestCaseTwoArgs{lhs: 1001498330, rhs: 865553472, expected: 135944858},
        TestCaseTwoArgs{lhs: 412434553, rhs: 0b11000001001101010110001010011010, expected: 1465900511}, // rhs = -1053465958
        TestCaseTwoArgs{lhs: 0b10101111100011010111101010111100, rhs: 1103768677, expected: 2147483648}, // lhs = -1349682500
        TestCaseTwoArgs{lhs: 439061045, rhs: 0b10010110011011111010111011100110, expected: 2147483647}, // rhs = -1771065626
        TestCaseTwoArgs{lhs: 1120232522, rhs: 110046791, expected: 1010185731},
        TestCaseTwoArgs{lhs: 365377728, rhs: 0b10100010011111000011010001010010, expected: 1934296174}, // rhs = -1568918446
        TestCaseTwoArgs{lhs: 0b10011001110000111001010011101000, rhs: 0b11100111011101000001011000010101, expected: 2991554259}, // lhs = -1715235608 rhs = -411822571
        TestCaseTwoArgs{lhs: 2132667991, rhs: 0b10111011101101100111011011100000, expected: 2147483647}, // rhs = -1145669920
        TestCaseTwoArgs{lhs: 385896408, rhs: 973731694, expected: 3707132010},
        TestCaseTwoArgs{lhs: 1344532431, rhs: 134520969, expected: 1210011462},
        TestCaseTwoArgs{lhs: 1018885099, rhs: 0b10100010000011000000000010000110, expected: 2147483647}, // rhs = -1576271738
        TestCaseTwoArgs{lhs: 1696822934, rhs: 1557907355, expected: 138915579},
        TestCaseTwoArgs{lhs: 2054357660, rhs: 1631741525, expected: 422616135},
        TestCaseTwoArgs{lhs: 610482138, rhs: 1776090867, expected: 3129358567},
        TestCaseTwoArgs{lhs: 1729517244, rhs: 899451558, expected: 830065686},
        TestCaseTwoArgs{lhs: 2072287058, rhs: 414359297, expected: 1657927761},
        TestCaseTwoArgs{lhs: 0b11110101010001111011011100111000, rhs: 0b10001011101000010000111011011001, expected: 1772529759}, // lhs = -179849416 rhs = -1952379175
        TestCaseTwoArgs{lhs: 2058819465, rhs: 862373367, expected: 1196446098},
        TestCaseTwoArgs{lhs: 0b11011111110100110010001111111110, rhs: 326969092, expected: 3428187386}, // lhs = -539810818
        TestCaseTwoArgs{lhs: 0b11011101010010110001100000110000, rhs: 1561915711, expected: 2150770417}, // lhs = -582281168

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 0, expected: 0},
        TestCaseTwoArgs{lhs: 0, rhs: 2147483647, expected: 2147483649},
        TestCaseTwoArgs{lhs: 0, rhs: 0b10000000000000000000000000000000, expected: 2147483647}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0, expected: 2147483647},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 2147483647, expected: 0},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0b10000000000000000000000000000000, expected: 2147483647}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0, expected: 2147483648}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 2147483647, expected: 2147483648}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0b10000000000000000000000000000000, expected: 0}, // lhs = -2147483648 rhs = -2147483648
    ];
    #[test]
    fn test_i32() {
        for case in test_cases.span() {
            assert_eq!(__llvm_ssub_sat_i_i_i(*case.lhs, *case.rhs), *case.expected);
        }
    }
}
