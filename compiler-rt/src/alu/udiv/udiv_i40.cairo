use crate::rtstate::RTState;
use crate::alu::udiv::udiv;
use crate::integer::u40::u40;

pub fn __llvm_udiv_n_n_n(ref state: RTState, lhs: u128, rhs: u128) -> u128 {
    udiv::<u40>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use crate::rtstate::RTStateOps;
    use super::__llvm_udiv_n_n_n;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 202] = [
        // Random test cases
        TestCaseTwoArgs{lhs: 899298276929, rhs: 86860649495, expected: 10},
        TestCaseTwoArgs{lhs: 1083097390879, rhs: 1076442829010, expected: 1},
        TestCaseTwoArgs{lhs: 473443285340, rhs: 986788206567, expected: 0},
        TestCaseTwoArgs{lhs: 943584959484, rhs: 92905779996, expected: 10},
        TestCaseTwoArgs{lhs: 15153946034, rhs: 399379168181, expected: 0},
        TestCaseTwoArgs{lhs: 630863301715, rhs: 1009744859435, expected: 0},
        TestCaseTwoArgs{lhs: 641197160550, rhs: 728174826859, expected: 0},
        TestCaseTwoArgs{lhs: 451561028638, rhs: 586861443736, expected: 0},
        TestCaseTwoArgs{lhs: 69927497608, rhs: 955314503904, expected: 0},
        TestCaseTwoArgs{lhs: 180475539539, rhs: 138792153972, expected: 1},
        TestCaseTwoArgs{lhs: 1081693387800, rhs: 695292925782, expected: 1},
        TestCaseTwoArgs{lhs: 594306653371, rhs: 485188443322, expected: 1},
        TestCaseTwoArgs{lhs: 445482897533, rhs: 142774752576, expected: 3},
        TestCaseTwoArgs{lhs: 211932755632, rhs: 805102934078, expected: 0},
        TestCaseTwoArgs{lhs: 1076208139484, rhs: 761007220782, expected: 1},
        TestCaseTwoArgs{lhs: 18630506564, rhs: 1097523943326, expected: 0},
        TestCaseTwoArgs{lhs: 177362948044, rhs: 826783508360, expected: 0},
        TestCaseTwoArgs{lhs: 135738463855, rhs: 80205722828, expected: 1},
        TestCaseTwoArgs{lhs: 335136878520, rhs: 208117665203, expected: 1},
        TestCaseTwoArgs{lhs: 669641898876, rhs: 482779708138, expected: 1},
        TestCaseTwoArgs{lhs: 242700246692, rhs: 1071470973642, expected: 0},
        TestCaseTwoArgs{lhs: 355663015713, rhs: 729581879897, expected: 0},
        TestCaseTwoArgs{lhs: 1050370138807, rhs: 29354048450, expected: 35},
        TestCaseTwoArgs{lhs: 96617467800, rhs: 1045080010919, expected: 0},
        TestCaseTwoArgs{lhs: 667300301485, rhs: 748990112086, expected: 0},
        TestCaseTwoArgs{lhs: 173844859439, rhs: 766347588322, expected: 0},
        TestCaseTwoArgs{lhs: 488097060195, rhs: 348011120269, expected: 1},
        TestCaseTwoArgs{lhs: 205707000215, rhs: 106123950376, expected: 1},
        TestCaseTwoArgs{lhs: 1082596368466, rhs: 588549314137, expected: 1},
        TestCaseTwoArgs{lhs: 373779434486, rhs: 391980523906, expected: 0},
        TestCaseTwoArgs{lhs: 782373081168, rhs: 1008389141040, expected: 0},
        TestCaseTwoArgs{lhs: 43846177505, rhs: 430145184848, expected: 0},
        TestCaseTwoArgs{lhs: 980370213916, rhs: 783443357989, expected: 1},
        TestCaseTwoArgs{lhs: 325342151165, rhs: 485001774589, expected: 0},
        TestCaseTwoArgs{lhs: 244220483016, rhs: 83518251057, expected: 2},
        TestCaseTwoArgs{lhs: 978246149872, rhs: 653439857471, expected: 1},
        TestCaseTwoArgs{lhs: 1046332379564, rhs: 708818632941, expected: 1},
        TestCaseTwoArgs{lhs: 1046819751452, rhs: 153346718284, expected: 6},
        TestCaseTwoArgs{lhs: 974986715643, rhs: 459139066841, expected: 2},
        TestCaseTwoArgs{lhs: 557425969775, rhs: 770192928206, expected: 0},
        TestCaseTwoArgs{lhs: 448873074521, rhs: 948283885627, expected: 0},
        TestCaseTwoArgs{lhs: 903069388014, rhs: 625571622450, expected: 1},
        TestCaseTwoArgs{lhs: 789762062734, rhs: 700359640196, expected: 1},
        TestCaseTwoArgs{lhs: 419315786522, rhs: 755298318935, expected: 0},
        TestCaseTwoArgs{lhs: 76919741285, rhs: 774279544051, expected: 0},
        TestCaseTwoArgs{lhs: 269428171159, rhs: 681672087337, expected: 0},
        TestCaseTwoArgs{lhs: 589192170184, rhs: 483654367625, expected: 1},
        TestCaseTwoArgs{lhs: 190550621824, rhs: 213616216974, expected: 0},
        TestCaseTwoArgs{lhs: 907685363093, rhs: 233236886775, expected: 3},
        TestCaseTwoArgs{lhs: 951430789723, rhs: 258714311984, expected: 3},
        TestCaseTwoArgs{lhs: 792782308292, rhs: 161202862551, expected: 4},
        TestCaseTwoArgs{lhs: 126406277803, rhs: 598522761620, expected: 0},
        TestCaseTwoArgs{lhs: 395468744666, rhs: 122694485736, expected: 3},
        TestCaseTwoArgs{lhs: 1030279917656, rhs: 779423760372, expected: 1},
        TestCaseTwoArgs{lhs: 254203276788, rhs: 106766433019, expected: 2},
        TestCaseTwoArgs{lhs: 685387549198, rhs: 993089231338, expected: 0},
        TestCaseTwoArgs{lhs: 260432120562, rhs: 863523095367, expected: 0},
        TestCaseTwoArgs{lhs: 465332589524, rhs: 1014600606839, expected: 0},
        TestCaseTwoArgs{lhs: 764749010153, rhs: 877107582812, expected: 0},
        TestCaseTwoArgs{lhs: 554363418747, rhs: 173156291702, expected: 3},
        TestCaseTwoArgs{lhs: 383632804224, rhs: 941897877535, expected: 0},
        TestCaseTwoArgs{lhs: 550704819275, rhs: 455396981935, expected: 1},
        TestCaseTwoArgs{lhs: 951644386069, rhs: 263859167510, expected: 3},
        TestCaseTwoArgs{lhs: 409626235031, rhs: 1050069665637, expected: 0},
        TestCaseTwoArgs{lhs: 592479663530, rhs: 562332263149, expected: 1},
        TestCaseTwoArgs{lhs: 1035443635002, rhs: 669210726065, expected: 1},
        TestCaseTwoArgs{lhs: 1039041225772, rhs: 448549068461, expected: 2},
        TestCaseTwoArgs{lhs: 998099350546, rhs: 1096028846737, expected: 0},
        TestCaseTwoArgs{lhs: 951426090052, rhs: 721537946985, expected: 1},
        TestCaseTwoArgs{lhs: 68581903903, rhs: 200792993155, expected: 0},
        TestCaseTwoArgs{lhs: 208925519633, rhs: 1070928823497, expected: 0},
        TestCaseTwoArgs{lhs: 111283386248, rhs: 1078735428230, expected: 0},
        TestCaseTwoArgs{lhs: 406263190465, rhs: 713410205245, expected: 0},
        TestCaseTwoArgs{lhs: 496102452152, rhs: 249205915998, expected: 1},
        TestCaseTwoArgs{lhs: 737437902271, rhs: 1007140494506, expected: 0},
        TestCaseTwoArgs{lhs: 256338195393, rhs: 456120296302, expected: 0},
        TestCaseTwoArgs{lhs: 108465314432, rhs: 550243387226, expected: 0},
        TestCaseTwoArgs{lhs: 853734566309, rhs: 979089138237, expected: 0},
        TestCaseTwoArgs{lhs: 154176963799, rhs: 829336248742, expected: 0},
        TestCaseTwoArgs{lhs: 1015039362773, rhs: 833165689110, expected: 1},
        TestCaseTwoArgs{lhs: 284026058488, rhs: 201734991354, expected: 1},
        TestCaseTwoArgs{lhs: 345652818745, rhs: 908003025869, expected: 0},
        TestCaseTwoArgs{lhs: 511406873240, rhs: 861617123840, expected: 0},
        TestCaseTwoArgs{lhs: 606467544855, rhs: 464274199209, expected: 1},
        TestCaseTwoArgs{lhs: 416639074645, rhs: 944398832608, expected: 0},
        TestCaseTwoArgs{lhs: 1089511908493, rhs: 1064394231356, expected: 1},
        TestCaseTwoArgs{lhs: 153792668863, rhs: 1527026165, expected: 100},
        TestCaseTwoArgs{lhs: 1075370417799, rhs: 561193549778, expected: 1},
        TestCaseTwoArgs{lhs: 117090822477, rhs: 384922724825, expected: 0},
        TestCaseTwoArgs{lhs: 683251336951, rhs: 726709911540, expected: 0},
        TestCaseTwoArgs{lhs: 57586541831, rhs: 657202489653, expected: 0},
        TestCaseTwoArgs{lhs: 119098479040, rhs: 744806371274, expected: 0},
        TestCaseTwoArgs{lhs: 543553959031, rhs: 109688631282, expected: 4},
        TestCaseTwoArgs{lhs: 475285019200, rhs: 427567867739, expected: 1},
        TestCaseTwoArgs{lhs: 895290290272, rhs: 485332069604, expected: 1},
        TestCaseTwoArgs{lhs: 990861791328, rhs: 970698084030, expected: 1},
        TestCaseTwoArgs{lhs: 474044662644, rhs: 566595925262, expected: 0},
        TestCaseTwoArgs{lhs: 296399517565, rhs: 870571194489, expected: 0},
        TestCaseTwoArgs{lhs: 523364702809, rhs: 130494062836, expected: 4},
        TestCaseTwoArgs{lhs: 689826824016, rhs: 239803030325, expected: 2},
        TestCaseTwoArgs{lhs: 697524672241, rhs: 66787815318, expected: 10},
        TestCaseTwoArgs{lhs: 129357934670, rhs: 364448150928, expected: 0},
        TestCaseTwoArgs{lhs: 846878225333, rhs: 284741759810, expected: 2},
        TestCaseTwoArgs{lhs: 411758280124, rhs: 740214151586, expected: 0},
        TestCaseTwoArgs{lhs: 195749389400, rhs: 175362814943, expected: 1},
        TestCaseTwoArgs{lhs: 155623767360, rhs: 1048314286140, expected: 0},
        TestCaseTwoArgs{lhs: 850729369420, rhs: 874481851660, expected: 0},
        TestCaseTwoArgs{lhs: 1066270202641, rhs: 271040512818, expected: 3},
        TestCaseTwoArgs{lhs: 913702388623, rhs: 364143011986, expected: 2},
        TestCaseTwoArgs{lhs: 664618712347, rhs: 570024749616, expected: 1},
        TestCaseTwoArgs{lhs: 540128440003, rhs: 810303085419, expected: 0},
        TestCaseTwoArgs{lhs: 95525566975, rhs: 332674538089, expected: 0},
        TestCaseTwoArgs{lhs: 909548160087, rhs: 955741880516, expected: 0},
        TestCaseTwoArgs{lhs: 300857103765, rhs: 219831382726, expected: 1},
        TestCaseTwoArgs{lhs: 188914724485, rhs: 207746176509, expected: 0},
        TestCaseTwoArgs{lhs: 756063397208, rhs: 399367752687, expected: 1},
        TestCaseTwoArgs{lhs: 610927027824, rhs: 328300770315, expected: 1},
        TestCaseTwoArgs{lhs: 1059356498731, rhs: 947196039306, expected: 1},
        TestCaseTwoArgs{lhs: 764411083985, rhs: 974750322814, expected: 0},
        TestCaseTwoArgs{lhs: 1010525698898, rhs: 755298548076, expected: 1},
        TestCaseTwoArgs{lhs: 1094560656715, rhs: 268030908068, expected: 4},
        TestCaseTwoArgs{lhs: 885038781903, rhs: 740844973053, expected: 1},
        TestCaseTwoArgs{lhs: 375271936665, rhs: 965951587123, expected: 0},
        TestCaseTwoArgs{lhs: 1041358685309, rhs: 247657514259, expected: 4},
        TestCaseTwoArgs{lhs: 447444465529, rhs: 960699116312, expected: 0},
        TestCaseTwoArgs{lhs: 494526169811, rhs: 692047421746, expected: 0},
        TestCaseTwoArgs{lhs: 605276188902, rhs: 376924411741, expected: 1},
        TestCaseTwoArgs{lhs: 437611380221, rhs: 553905529540, expected: 0},
        TestCaseTwoArgs{lhs: 942215881818, rhs: 451499174566, expected: 2},
        TestCaseTwoArgs{lhs: 1028139399635, rhs: 285775107788, expected: 3},
        TestCaseTwoArgs{lhs: 52625782011, rhs: 751270784226, expected: 0},
        TestCaseTwoArgs{lhs: 399403620589, rhs: 685059228569, expected: 0},
        TestCaseTwoArgs{lhs: 936282194999, rhs: 576883431299, expected: 1},
        TestCaseTwoArgs{lhs: 473861262295, rhs: 321144789155, expected: 1},
        TestCaseTwoArgs{lhs: 760697995148, rhs: 339321894356, expected: 2},
        TestCaseTwoArgs{lhs: 965388998172, rhs: 946245688464, expected: 1},
        TestCaseTwoArgs{lhs: 351669163491, rhs: 901944801941, expected: 0},
        TestCaseTwoArgs{lhs: 666940962494, rhs: 728445868839, expected: 0},
        TestCaseTwoArgs{lhs: 1021318052304, rhs: 801913408041, expected: 1},
        TestCaseTwoArgs{lhs: 519644481463, rhs: 500719525599, expected: 1},
        TestCaseTwoArgs{lhs: 178645304786, rhs: 1009287872177, expected: 0},
        TestCaseTwoArgs{lhs: 274266576236, rhs: 998209139481, expected: 0},
        TestCaseTwoArgs{lhs: 783836635446, rhs: 292255041260, expected: 2},
        TestCaseTwoArgs{lhs: 1036364009453, rhs: 874394341483, expected: 1},
        TestCaseTwoArgs{lhs: 706351333319, rhs: 80391629082, expected: 8},
        TestCaseTwoArgs{lhs: 1095580255597, rhs: 1087706352088, expected: 1},
        TestCaseTwoArgs{lhs: 321238409453, rhs: 882209632137, expected: 0},
        TestCaseTwoArgs{lhs: 974200080599, rhs: 1028434764152, expected: 0},
        TestCaseTwoArgs{lhs: 1096121030752, rhs: 555421044027, expected: 1},
        TestCaseTwoArgs{lhs: 976698761096, rhs: 395871668605, expected: 2},
        TestCaseTwoArgs{lhs: 350129502579, rhs: 959419977041, expected: 0},
        TestCaseTwoArgs{lhs: 629979478362, rhs: 248007735103, expected: 2},
        TestCaseTwoArgs{lhs: 907513717988, rhs: 801648763965, expected: 1},
        TestCaseTwoArgs{lhs: 5998055603, rhs: 52483209692, expected: 0},
        TestCaseTwoArgs{lhs: 306185477837, rhs: 1032454501526, expected: 0},
        TestCaseTwoArgs{lhs: 446642598775, rhs: 659456564105, expected: 0},
        TestCaseTwoArgs{lhs: 1097278574863, rhs: 500179954569, expected: 2},
        TestCaseTwoArgs{lhs: 705156285813, rhs: 805094036946, expected: 0},
        TestCaseTwoArgs{lhs: 222392206077, rhs: 105417027320, expected: 2},
        TestCaseTwoArgs{lhs: 555416517475, rhs: 85787788681, expected: 6},
        TestCaseTwoArgs{lhs: 619988475938, rhs: 197190161145, expected: 3},
        TestCaseTwoArgs{lhs: 599045080458, rhs: 851698942825, expected: 0},
        TestCaseTwoArgs{lhs: 1024878145490, rhs: 826861936828, expected: 1},
        TestCaseTwoArgs{lhs: 840998314056, rhs: 962898310428, expected: 0},
        TestCaseTwoArgs{lhs: 367964778976, rhs: 404224112356, expected: 0},
        TestCaseTwoArgs{lhs: 1090138417185, rhs: 367534739071, expected: 2},
        TestCaseTwoArgs{lhs: 233400067781, rhs: 127866056327, expected: 1},
        TestCaseTwoArgs{lhs: 370959963637, rhs: 482727035165, expected: 0},
        TestCaseTwoArgs{lhs: 492562753288, rhs: 1075874289381, expected: 0},
        TestCaseTwoArgs{lhs: 757139936155, rhs: 632569584670, expected: 1},
        TestCaseTwoArgs{lhs: 393960446115, rhs: 498718163117, expected: 0},
        TestCaseTwoArgs{lhs: 184872652426, rhs: 727651483518, expected: 0},
        TestCaseTwoArgs{lhs: 284365540666, rhs: 242779295750, expected: 1},
        TestCaseTwoArgs{lhs: 768928171511, rhs: 261049736407, expected: 2},
        TestCaseTwoArgs{lhs: 888595663915, rhs: 994159808932, expected: 0},
        TestCaseTwoArgs{lhs: 781444518931, rhs: 195162520749, expected: 4},
        TestCaseTwoArgs{lhs: 879707565016, rhs: 66091782455, expected: 13},
        TestCaseTwoArgs{lhs: 761389438363, rhs: 394454024140, expected: 1},
        TestCaseTwoArgs{lhs: 835406299765, rhs: 635953097794, expected: 1},
        TestCaseTwoArgs{lhs: 836598720612, rhs: 807461263580, expected: 1},
        TestCaseTwoArgs{lhs: 989529912453, rhs: 722243561958, expected: 1},
        TestCaseTwoArgs{lhs: 889354627671, rhs: 195487003908, expected: 4},
        TestCaseTwoArgs{lhs: 18604802612, rhs: 1008036457274, expected: 0},
        TestCaseTwoArgs{lhs: 284592178558, rhs: 1086616708038, expected: 0},
        TestCaseTwoArgs{lhs: 961530644424, rhs: 1084420297909, expected: 0},
        TestCaseTwoArgs{lhs: 63462640054, rhs: 83914321011, expected: 0},
        TestCaseTwoArgs{lhs: 879228111044, rhs: 968202594070, expected: 0},
        TestCaseTwoArgs{lhs: 456808768704, rhs: 979720871413, expected: 0},
        TestCaseTwoArgs{lhs: 1036383243061, rhs: 941567630168, expected: 1},
        TestCaseTwoArgs{lhs: 547103945324, rhs: 4202684785, expected: 130},
        TestCaseTwoArgs{lhs: 941530109959, rhs: 936936997760, expected: 1},
        TestCaseTwoArgs{lhs: 831239615034, rhs: 938806872889, expected: 0},
        TestCaseTwoArgs{lhs: 302424638540, rhs: 69114611227, expected: 4},
        TestCaseTwoArgs{lhs: 55381357470, rhs: 722752775107, expected: 0},
        TestCaseTwoArgs{lhs: 1091288992557, rhs: 1079947555429, expected: 1},
        TestCaseTwoArgs{lhs: 931848638382, rhs: 208267374045, expected: 4},
        TestCaseTwoArgs{lhs: 1003561035687, rhs: 298744007049, expected: 3},
        TestCaseTwoArgs{lhs: 347153464908, rhs: 849205090521, expected: 0},
        TestCaseTwoArgs{lhs: 828378739931, rhs: 1044568757041, expected: 0},
        TestCaseTwoArgs{lhs: 652766294251, rhs: 44911046230, expected: 14},

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 1099511627775, expected: 0},
        TestCaseTwoArgs{lhs: 1099511627775, rhs: 1099511627775, expected: 1},
    ];

    #[test]
    fn test_i40() {
        for case in test_cases.span() {
            let mut state = RTStateOps::new();
            assert_eq!(__llvm_udiv_n_n_n(ref state, *case.lhs, *case.rhs), *case.expected);
        }
    }
}
