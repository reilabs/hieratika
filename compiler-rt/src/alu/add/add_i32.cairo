use crate::alu::add::add;

pub fn __llvm_add_i_i_i(lhs: u128, rhs: u128) -> u128 {
    add::<u32>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use super::__llvm_add_i_i_i;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 129] = [
        // Due to Cairo's casting limitation, negative numbers are represented as bit patterns.

        // Random test cases
        TestCaseTwoArgs{lhs: 0b10010010111000101000101110000111, rhs: 1917399477, expected: 86752572}, // lhs = -1830646905
        TestCaseTwoArgs{lhs: 0b10101110111101011101111000100101, rhs: 281202230, expected: 3216551003}, // lhs = -1359618523
        TestCaseTwoArgs{lhs: 822377905, rhs: 1693712911, expected: 2516090816},
        TestCaseTwoArgs{lhs: 0b11111110001111100100000011001011, rhs: 0b10110100111111001111011001110000, expected: 3007002427}, // lhs = -29474613 rhs = -1258490256
        TestCaseTwoArgs{lhs: 1559129394, rhs: 0b10111101001100000101110110111100, expected: 438225646}, // rhs = -1120903748
        TestCaseTwoArgs{lhs: 0b11011000010001011000101010110101, rhs: 1268386093, expected: 601854946}, // lhs = -666531147
        TestCaseTwoArgs{lhs: 0b10101011000000001111110100000000, rhs: 0b11100000101011000011001000000000, expected: 2343382784}, // lhs = -1425998592 rhs = -525585920
        TestCaseTwoArgs{lhs: 0b10101011111100101000110011110011, rhs: 0b11011111100101001100111000110000, expected: 2340903715}, // lhs = -1410167565 rhs = -543896016
        TestCaseTwoArgs{lhs: 570114563, rhs: 0b11111100101101001011011101110101, expected: 514849144}, // rhs = -55265419
        TestCaseTwoArgs{lhs: 243908698, rhs: 2110324816, expected: 2354233514},
        TestCaseTwoArgs{lhs: 0b11000010110100101010100001101011, rhs: 1251092394, expected: 224710677}, // lhs = -1026381717
        TestCaseTwoArgs{lhs: 576142202, rhs: 0b10100011000001010101010011011010, expected: 3311177812}, // rhs = -1559931686
        TestCaseTwoArgs{lhs: 0b10000001001010101010000110001110, rhs: 1931369786, expected: 4098424520}, // lhs = -2127912562
        TestCaseTwoArgs{lhs: 305423412, rhs: 0b11001001100000010001100101111000, expected: 3686104492}, // rhs = -914286216
        TestCaseTwoArgs{lhs: 0b11001101110001000111010101011001, rhs: 0b11011011011000010110110100110000, expected: 2837832329}, // lhs = -842762919 rhs = -614372048
        TestCaseTwoArgs{lhs: 0b10111000110110110111110100001110, rhs: 1817013700, expected: 623438546}, // lhs = -1193575154
        TestCaseTwoArgs{lhs: 1828854108, rhs: 0b10101010000010100001100010100100, expected: 386675200}, // rhs = -1442178908
        TestCaseTwoArgs{lhs: 1547415919, rhs: 0b11010101011000110100111101100111, expected: 832504022}, // rhs = -714911897
        TestCaseTwoArgs{lhs: 0b10011110110001000100011111110101, rhs: 0b11001001011000010101100100100101, expected: 1747296538}, // lhs = -1631303691 rhs = -916367067
        TestCaseTwoArgs{lhs: 205842946, rhs: 0b10101010000001000010101100010000, expected: 3058242834}, // rhs = -1442567408
        TestCaseTwoArgs{lhs: 0b10110101111000111011011010010000, rhs: 0b11010101110101000111000011010010, expected: 2344101730}, // lhs = -1243367792 rhs = -707497774
        TestCaseTwoArgs{lhs: 312239175, rhs: 1150711688, expected: 1462950863},
        TestCaseTwoArgs{lhs: 980161830, rhs: 0b11101011101101000110011010011111, expected: 639663045}, // rhs = -340498785
        TestCaseTwoArgs{lhs: 0b10111101100000001010100011000110, rhs: 0b11001000000001000101010110000101, expected: 2240085579}, // lhs = -1115641658 rhs = -939240059
        TestCaseTwoArgs{lhs: 2038808499, rhs: 782253405, expected: 2821061904},
        TestCaseTwoArgs{lhs: 0b11100111101110011001001100010011, rhs: 0b11001101001111010100001100101010, expected: 3036075581}, // lhs = -407268589 rhs = -851623126
        TestCaseTwoArgs{lhs: 0b10000101011001101000111011100111, rhs: 0b11011101100100010111000000010110, expected: 1660419837}, // lhs = -2056876313 rhs = -577671146
        TestCaseTwoArgs{lhs: 557960388, rhs: 0b11011000010111110001101101010001, expected: 4188071957}, // rhs = -664855727
        TestCaseTwoArgs{lhs: 1806765939, rhs: 1476711799, expected: 3283477738},
        TestCaseTwoArgs{lhs: 1554671909, rhs: 1601406603, expected: 3156078512},
        TestCaseTwoArgs{lhs: 0b10101001111010001111101011000101, rhs: 0b10000110000011110100101000001001, expected: 804799694}, // lhs = -1444349243 rhs = -2045818359
        TestCaseTwoArgs{lhs: 0b11110110011111111000011101010100, rhs: 32708987, expected: 4168261839}, // lhs = -159414444
        TestCaseTwoArgs{lhs: 0b10110100101111111100101111101011, rhs: 0b10010110001111100111110101110001, expected: 1258178908}, // lhs = -1262498837 rhs = -1774289551
        TestCaseTwoArgs{lhs: 0b10001110111100010100100011000001, rhs: 0b10111111101110000010110101000011, expected: 1319728644}, // lhs = -1896789823 rhs = -1078448829
        TestCaseTwoArgs{lhs: 0b11000011110100001100001100011110, rhs: 1286215761, expected: 276487023}, // lhs = -1009728738
        TestCaseTwoArgs{lhs: 0b11111011001111110001110001110100, rhs: 0b10011011100001000010111101000110, expected: 2529381306}, // lhs = -79750028 rhs = -1685835962
        TestCaseTwoArgs{lhs: 0b11111101011011001001101011100100, rhs: 1445199425, expected: 1401985317}, // lhs = -43214108
        TestCaseTwoArgs{lhs: 0b10100101110111111111011110101000, rhs: 0b10101011101000101100101100001010, expected: 1367524018}, // lhs = -1512048728 rhs = -1415394550
        TestCaseTwoArgs{lhs: 0b10011111010000101001011100111001, rhs: 1153327326, expected: 3825268759}, // lhs = -1623025863
        TestCaseTwoArgs{lhs: 0b10111100111011100101100001111011, rhs: 0b11110010010101110110011101100011, expected: 2940583902}, // lhs = -1125230469 rhs = -229152925
        TestCaseTwoArgs{lhs: 0b10010101111011001110011111110000, rhs: 1132196805, expected: 3647527861}, // lhs = -1779636240
        TestCaseTwoArgs{lhs: 0b11000000100110101011100011010100, rhs: 415724409, expected: 3647089741}, // lhs = -1063601964
        TestCaseTwoArgs{lhs: 0b10100001001110110101101010101111, rhs: 1411483254, expected: 4116504869}, // lhs = -1589945681
        TestCaseTwoArgs{lhs: 0b11100000111001110111111110000010, rhs: 0b11100111001000010110100000111001, expected: 3356026811}, // lhs = -521699454 rhs = -417241031
        TestCaseTwoArgs{lhs: 0b10100100101100111100111001001011, rhs: 1521588314, expected: 4284835493}, // lhs = -1531720117
        TestCaseTwoArgs{lhs: 1816744779, rhs: 1931636454, expected: 3748381233},
        TestCaseTwoArgs{lhs: 0b10100101011101111100111110100101, rhs: 0b10111010001101100001100011101010, expected: 1605232783}, // lhs = -1518874715 rhs = -1170859798
        TestCaseTwoArgs{lhs: 0b10010100110010111000000010100011, rhs: 2066760809, expected: 268158220}, // lhs = -1798602589
        TestCaseTwoArgs{lhs: 767139000, rhs: 0b10000010010010000100101010101110, expected: 2952914790}, // rhs = -2109191506
        TestCaseTwoArgs{lhs: 0b10010110011100101011101011100001, rhs: 1391180124, expected: 3915281469}, // lhs = -1770865951
        TestCaseTwoArgs{lhs: 0b11111101101010011010110001100000, rhs: 0b11101001000000010010010110000000, expected: 3869954528}, // lhs = -39211936 rhs = -385800832
        TestCaseTwoArgs{lhs: 0b10000100001001000011110101010101, rhs: 1502164808, expected: 3719132317}, // lhs = -2077999787
        TestCaseTwoArgs{lhs: 0b11100111000001101110001110100010, rhs: 0b11011011010111101111100011010100, expected: 3261455478}, // lhs = -418978910 rhs = -614532908
        TestCaseTwoArgs{lhs: 493444177, rhs: 1337461887, expected: 1830906064},
        TestCaseTwoArgs{lhs: 733369426, rhs: 1621720909, expected: 2355090335},
        TestCaseTwoArgs{lhs: 0b11100100010111010111011101010010, rhs: 0b10011001001110001010100000001000, expected: 2106990426}, // lhs = -463636654 rhs = -1724340216
        TestCaseTwoArgs{lhs: 2025393677, rhs: 1251524923, expected: 3276918600},
        TestCaseTwoArgs{lhs: 2079935191, rhs: 0b11111100111100001001100100000010, expected: 2028594137}, // rhs = -51341054
        TestCaseTwoArgs{lhs: 0b10010110001010100111000111101011, rhs: 246208277, expected: 2765572352}, // lhs = -1775603221
        TestCaseTwoArgs{lhs: 0b10010000111010010110010100010110, rhs: 0b10111010010011111010001101011101, expected: 1262028915}, // lhs = -1863752426 rhs = -1169185955
        TestCaseTwoArgs{lhs: 0b11010001111001110101001000100000, rhs: 233015162, expected: 3754613146}, // lhs = -773369312
        TestCaseTwoArgs{lhs: 0b11011111011101110110110100111100, rhs: 0b10100100100100011110110110010000, expected: 2215205580}, // lhs = -545821380 rhs = -1533940336
        TestCaseTwoArgs{lhs: 0b11110100110010010011101101001001, rhs: 0b11010101000111101101110101111011, expected: 3387431108}, // lhs = -188138679 rhs = -719397509
        TestCaseTwoArgs{lhs: 2086827857, rhs: 0b11110010111011000000101001101111, expected: 1867416000}, // rhs = -219411857
        TestCaseTwoArgs{lhs: 1802394429, rhs: 0b10101101110110101001101100010011, expected: 424212048}, // rhs = -1378182381
        TestCaseTwoArgs{lhs: 0b10001110011010001100111000010111, rhs: 0b11000111111101110111111010000000, expected: 1449151639}, // lhs = -1905734121 rhs = -940081536
        TestCaseTwoArgs{lhs: 0b10011100100001101000110010111011, rhs: 0b10111011011111111010000100101000, expected: 1476799971}, // lhs = -1668903749 rhs = -1149263576
        TestCaseTwoArgs{lhs: 1814591951, rhs: 29102100, expected: 1843694051},
        TestCaseTwoArgs{lhs: 0b10011110111110110100101011000111, rhs: 621474117, expected: 3288742924}, // lhs = -1627698489
        TestCaseTwoArgs{lhs: 0b10000111101001011110100000110011, rhs: 0b11101000000111111010100100101110, expected: 1875218785}, // lhs = -2019170253 rhs = -400578258
        TestCaseTwoArgs{lhs: 0b11101110101101000100110001000110, rhs: 1090090735, expected: 799916853}, // lhs = -290173882
        TestCaseTwoArgs{lhs: 769820364, rhs: 0b10110111011000001001100111011011, expected: 3846381735}, // rhs = -1218405925
        TestCaseTwoArgs{lhs: 1236105520, rhs: 0b10000111011010101110110001111101, expected: 3508037037}, // rhs = -2023035779
        TestCaseTwoArgs{lhs: 1370045594, rhs: 0b10010010001001010101110101111000, expected: 3821967890}, // rhs = -1843045000
        TestCaseTwoArgs{lhs: 0b10100011001001111011101110001110, rhs: 828472653, expected: 3565762779}, // lhs = -1557677170
        TestCaseTwoArgs{lhs: 0b10101111010100010110101011111101, rhs: 0b11101011011001000111010011110101, expected: 2595610610}, // lhs = -1353618691 rhs = -345737995
        TestCaseTwoArgs{lhs: 0b11110010010111011110110011110011, rhs: 0b10010000000101011100011001001010, expected: 2188620605}, // lhs = -228725517 rhs = -1877621174
        TestCaseTwoArgs{lhs: 1910078329, rhs: 1666576878, expected: 3576655207},
        TestCaseTwoArgs{lhs: 1547387824, rhs: 0b11110001100000100101100010011100, expected: 1304271948}, // rhs = -243115876
        TestCaseTwoArgs{lhs: 1963287187, rhs: 1592812305, expected: 3556099492},
        TestCaseTwoArgs{lhs: 0b11010101100111001000000010000000, rhs: 0b10001001001101100111000110100110, expected: 1590882854}, // lhs = -711163776 rhs = -1992920666
        TestCaseTwoArgs{lhs: 0b10001001101100101001100001001110, rhs: 2011511232, expected: 26726926}, // lhs = -1984784306
        TestCaseTwoArgs{lhs: 1591578484, rhs: 928299754, expected: 2519878238},
        TestCaseTwoArgs{lhs: 0b11000010011101111001011110101010, rhs: 0b10000011010000101110011000111111, expected: 1169849833}, // lhs = -1032349782 rhs = -2092767681
        TestCaseTwoArgs{lhs: 0b11011100101001000011110111110001, rhs: 0b11101010000011110000111011000110, expected: 3333639351}, // lhs = -593216015 rhs = -368111930
        TestCaseTwoArgs{lhs: 0b10010001010000111110100101000111, rhs: 0b11001011101001111111000101000101, expected: 1558960780}, // lhs = -1857820345 rhs = -878186171
        TestCaseTwoArgs{lhs: 225425709, rhs: 125094567, expected: 350520276},
        TestCaseTwoArgs{lhs: 1857191474, rhs: 141736947, expected: 1998928421},
        TestCaseTwoArgs{lhs: 1604296112, rhs: 1480832325, expected: 3085128437},
        TestCaseTwoArgs{lhs: 1129453709, rhs: 574637685, expected: 1704091394},
        TestCaseTwoArgs{lhs: 0b11100011101111001100011011101010, rhs: 394665902, expected: 4215465624}, // lhs = -474167574
        TestCaseTwoArgs{lhs: 748771341, rhs: 0b10101110000001100011101101000100, expected: 3668415313}, // rhs = -1375323324
        TestCaseTwoArgs{lhs: 0b11101001110110011100100000100000, rhs: 0b10000001011000100000011110001100, expected: 1799081900}, // lhs = -371603424 rhs = -2124281972
        TestCaseTwoArgs{lhs: 819253901, rhs: 0b10001101001100111110111111010000, expected: 3188245085}, // rhs = -1925976112
        TestCaseTwoArgs{lhs: 1950854969, rhs: 0b10000101011111000001001100100010, expected: 4190356059}, // rhs = -2055466206
        TestCaseTwoArgs{lhs: 0b11010110101111001100001101000000, rhs: 0b10011100000001101100100100111100, expected: 1925418108}, // lhs = -692272320 rhs = -1677276868
        TestCaseTwoArgs{lhs: 524112794, rhs: 0b11111100001001010110001101101011, expected: 459454213}, // rhs = -64658581
        TestCaseTwoArgs{lhs: 741372381, rhs: 1466082485, expected: 2207454866},
        TestCaseTwoArgs{lhs: 860292670, rhs: 0b11000000011011100100000001101010, expected: 4088743592}, // rhs = -1066516374
        TestCaseTwoArgs{lhs: 0b11110011000010010000100110100101, rhs: 0b10111000011100010000110010011100, expected: 2876905025}, // lhs = -217511515 rhs = -1200550756
        TestCaseTwoArgs{lhs: 776469052, rhs: 0b11101010010111000101000100011101, expected: 413420377}, // rhs = -363048675
        TestCaseTwoArgs{lhs: 541116126, rhs: 1102511274, expected: 1643627400},
        TestCaseTwoArgs{lhs: 0b11000001010000111010100001110100, rhs: 0b10001000010000011001010000001101, expected: 1233468545}, // lhs = -1052530572 rhs = -2008968179
        TestCaseTwoArgs{lhs: 0b11011001110000101111000010010011, rhs: 0b11010110000001110110101010011011, expected: 2949274414}, // lhs = -641535853 rhs = -704157029
        TestCaseTwoArgs{lhs: 1447005404, rhs: 914715336, expected: 2361720740},
        TestCaseTwoArgs{lhs: 1070900068, rhs: 1209341496, expected: 2280241564},
        TestCaseTwoArgs{lhs: 0b10110000000100000100001111100011, rhs: 1692924922, expected: 351813597}, // lhs = -1341111325
        TestCaseTwoArgs{lhs: 612068216, rhs: 614454993, expected: 1226523209},
        TestCaseTwoArgs{lhs: 557014411, rhs: 0b10111000011110011100111111000100, expected: 3652005199}, // rhs = -1199976508
        TestCaseTwoArgs{lhs: 0b10101010101110010000011011101010, rhs: 1448131243, expected: 17416597}, // lhs = -1430714646
        TestCaseTwoArgs{lhs: 0b11111000011011111001011110101001, rhs: 743951, expected: 4168806840}, // lhs = -126904407
        TestCaseTwoArgs{lhs: 0b11001101100011000011000010101000, rhs: 0b11110011111110010010110010110111, expected: 3246742879}, // lhs = -846450520 rhs = -201773897
        TestCaseTwoArgs{lhs: 1994659282, rhs: 0b11001100101111111011100001101111, expected: 1134808641}, // rhs = -859850641
        TestCaseTwoArgs{lhs: 1704500317, rhs: 0b10011100110000110001101011100000, expected: 39565117}, // rhs = -1664935200
        TestCaseTwoArgs{lhs: 0b10110001011001011101101000101000, rhs: 0b10000100111111011011011101111001, expected: 912495009}, // lhs = -1318725080 rhs = -2063747207
        TestCaseTwoArgs{lhs: 0b11101000101111011010001100100010, rhs: 1516595206, expected: 1126370088}, // lhs = -390225118
        TestCaseTwoArgs{lhs: 560314406, rhs: 2120046519, expected: 2680360925},
        TestCaseTwoArgs{lhs: 1444518265, rhs: 0b11011110100110110010101010011001, expected: 884261906}, // rhs = -560256359
        TestCaseTwoArgs{lhs: 1794023419, rhs: 0b11001111110110101110111011000011, expected: 986287806}, // rhs = -807735613
        TestCaseTwoArgs{lhs: 269161590, rhs: 1180781608, expected: 1449943198},

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 0, expected: 0},
        TestCaseTwoArgs{lhs: 0, rhs: 2147483647, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0, rhs: 0b10000000000000000000000000000000, expected: 2147483648}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0, expected: 2147483647},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 2147483647, expected: 4294967294},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0b10000000000000000000000000000000, expected: 4294967295}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0, expected: 2147483648}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 2147483647, expected: 4294967295}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0b10000000000000000000000000000000, expected: 0}, // lhs = -2147483648 rhs = -2147483648
    ];
    #[test]
    fn test_i32() {
        for case in test_cases.span() {
            assert_eq!(__llvm_add_i_i_i(*case.lhs, *case.rhs), *case.expected);
        }
    }
}
