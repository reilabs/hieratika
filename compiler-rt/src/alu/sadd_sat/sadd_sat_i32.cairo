use crate::alu::sadd_sat::sadd_sat;

pub fn __llvm_sadd_sat_i_i_i(lhs: u128, rhs: u128) -> u128 {
    sadd_sat::<u32>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use super::__llvm_sadd_sat_i_i_i;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 129] = [
        // Due to Cairo's casting limitation, negative numbers are represented as bit patterns.

        // Random test cases
        TestCaseTwoArgs{lhs: 0b11100111011010001101011001110100, rhs: 953114877, expected: 540555121}, // lhs = -412559756
        TestCaseTwoArgs{lhs: 0b11000110001101110000100001010100, rhs: 0b10000110111001101011010100100010, expected: 2147483648}, // lhs = -969471916 rhs = -2031700702
        TestCaseTwoArgs{lhs: 146674671, rhs: 0b11110001101100110110110000011100, expected: 4201742347}, // rhs = -239899620
        TestCaseTwoArgs{lhs: 0b10100101101111101011000110101110, rhs: 0b10011100110000011101111010011001, expected: 2147483648}, // lhs = -1514229330 rhs = -1665016167
        TestCaseTwoArgs{lhs: 0b11011101010000001011000011010110, rhs: 0b10100100111010111001000000111110, expected: 2183938324}, // lhs = -582962986 rhs = -1528065986
        TestCaseTwoArgs{lhs: 414620357, rhs: 0b10011011000110011001000000101001, expected: 3016764142}, // rhs = -1692823511
        TestCaseTwoArgs{lhs: 1746998916, rhs: 1756339217, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b11010110001110001110101110111000, rhs: 0b11001011011010111011111110100101, expected: 2711923549}, // lhs = -700912712 rhs = -882131035
        TestCaseTwoArgs{lhs: 0b10100111100011101000111010101100, rhs: 0b11010011011011010111011001010000, expected: 2147483648}, // lhs = -1483829588 rhs = -747801008
        TestCaseTwoArgs{lhs: 0b11001101100111111101101000010000, rhs: 0b10000001010000111011011100111001, expected: 2147483648}, // lhs = -845161968 rhs = -2126268615
        TestCaseTwoArgs{lhs: 0b10110010111101101001011101011111, rhs: 747604937, expected: 3750109992}, // lhs = -1292462241
        TestCaseTwoArgs{lhs: 827057188, rhs: 0b10000011110101110111101000001101, expected: 3038993969}, // rhs = -2083030515
        TestCaseTwoArgs{lhs: 0b11111010100001010000001001001010, rhs: 0b10111111000000111111110000010010, expected: 3112762972}, // lhs = -91946422 rhs = -1090257902
        TestCaseTwoArgs{lhs: 0b10111100011100100100000111111111, rhs: 0b10011111000110011110011000110001, expected: 2147483648}, // lhs = -1133362689 rhs = -1625692623
        TestCaseTwoArgs{lhs: 1578266956, rhs: 526075191, expected: 2104342147},
        TestCaseTwoArgs{lhs: 890342420, rhs: 0b11101100011001110011111000010000, expected: 561564196}, // rhs = -328778224
        TestCaseTwoArgs{lhs: 0b11001100010011101111110110011000, rhs: 795700732, expected: 4223429524}, // lhs = -867238504
        TestCaseTwoArgs{lhs: 1803713944, rhs: 0b10100101101111111111011110010100, expected: 289568044}, // rhs = -1514145900
        TestCaseTwoArgs{lhs: 597215607, rhs: 2097767935, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10101001011001111111110101010010, rhs: 0b10101000000011010000001100011101, expected: 2147483648}, // lhs = -1452802734 rhs = -1475542243
        TestCaseTwoArgs{lhs: 0b10100111000100011001010010100000, rhs: 2093478080, expected: 601458016}, // lhs = -1492020064
        TestCaseTwoArgs{lhs: 1716847724, rhs: 814370940, expected: 2147483647},
        TestCaseTwoArgs{lhs: 1323556957, rhs: 0b11001011011110000001111101000011, expected: 442236832}, // rhs = -881320125
        TestCaseTwoArgs{lhs: 0b11001011000111101110100001001011, rhs: 1143121903, expected: 255955002}, // lhs = -887166901
        TestCaseTwoArgs{lhs: 0b11000001100101000101110100001111, rhs: 0b11001010111011011010101001100110, expected: 2357331829}, // lhs = -1047241457 rhs = -890394010
        TestCaseTwoArgs{lhs: 559885095, rhs: 1439250426, expected: 1999135521},
        TestCaseTwoArgs{lhs: 1181757310, rhs: 0b10000011101011100100101001001000, expected: 3390994886}, // rhs = -2085729720
        TestCaseTwoArgs{lhs: 0b11000100000011001010110110110101, rhs: 1480949268, expected: 475147209}, // lhs = -1005802059
        TestCaseTwoArgs{lhs: 1615247653, rhs: 575830536, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b11011000001111010101010001011100, rhs: 0b11100011100010010111000011110010, expected: 3150366030}, // lhs = -667069348 rhs = -477531918
        TestCaseTwoArgs{lhs: 0b11111000001100001111100101110101, rhs: 0b11110011101011111011001100110101, expected: 3957370026}, // lhs = -131008139 rhs = -206589131
        TestCaseTwoArgs{lhs: 545875085, rhs: 0b10111110001100101100011010101001, expected: 3736873782}, // rhs = -1103968599
        TestCaseTwoArgs{lhs: 0b11000000010011001010011000110001, rhs: 0b10101010001001100110100111011100, expected: 2147483648}, // lhs = -1068718543 rhs = -1440323108
        TestCaseTwoArgs{lhs: 1197236046, rhs: 819214, expected: 1198055260},
        TestCaseTwoArgs{lhs: 1400391858, rhs: 0b10011100011001001110011010110010, expected: 4024250212}, // rhs = -1671108942
        TestCaseTwoArgs{lhs: 2023655043, rhs: 0b10101000011001000011001001011101, expected: 553826528}, // rhs = -1469828515
        TestCaseTwoArgs{lhs: 0b11000111100101010100001011110110, rhs: 0b10101111011010010100111010011000, expected: 2147483648}, // lhs = -946519306 rhs = -1352053096
        TestCaseTwoArgs{lhs: 0b10110101001110100010111101000001, rhs: 0b11001100100111110011100010101001, expected: 2178508778}, // lhs = -1254478015 rhs = -861980503
        TestCaseTwoArgs{lhs: 656994512, rhs: 0b10011001001101010001010111111011, expected: 3227387595}, // rhs = -1724574213
        TestCaseTwoArgs{lhs: 0b10110010000000101111010001101100, rhs: 0b11001101010000111000101110100000, expected: 2147483648}, // lhs = -1308429204 rhs = -851211360
        TestCaseTwoArgs{lhs: 0b11010111010101100110011111101010, rhs: 1736121320, expected: 1053918162}, // lhs = -682203158
        TestCaseTwoArgs{lhs: 0b11001000011110011111011111011101, rhs: 0b10101000001010100000001111111010, expected: 2147483648}, // lhs = -931530787 rhs = -1473641478
        TestCaseTwoArgs{lhs: 1691799601, rhs: 1843942597, expected: 2147483647},
        TestCaseTwoArgs{lhs: 712246864, rhs: 0b11100111000000001101111110111110, expected: 292873742}, // rhs = -419373122
        TestCaseTwoArgs{lhs: 0b11100010001110010101100010011010, rhs: 0b11011111110100100111001011101111, expected: 3255552905}, // lhs = -499558246 rhs = -539856145
        TestCaseTwoArgs{lhs: 0b10110100101000001011101101011001, rhs: 0b10011111010000101101010111100111, expected: 2147483648}, // lhs = -1264534695 rhs = -1623009817
        TestCaseTwoArgs{lhs: 0b11011001111000011000011110100011, rhs: 0b11110010001010000010000011110100, expected: 3423185047}, // lhs = -639531101 rhs = -232251148
        TestCaseTwoArgs{lhs: 1151906985, rhs: 0b10001110001011011101101111011001, expected: 3537277058}, // rhs = -1909597223
        TestCaseTwoArgs{lhs: 1952130829, rhs: 1919675974, expected: 2147483647},
        TestCaseTwoArgs{lhs: 1783855854, rhs: 39024485, expected: 1822880339},
        TestCaseTwoArgs{lhs: 0b10011001001110011010101100101110, rhs: 0b10101000000110011011100011000011, expected: 2147483648}, // lhs = -1724273874 rhs = -1474709309
        TestCaseTwoArgs{lhs: 363570870, rhs: 0b10101010001110100101001111010001, expected: 3219520135}, // rhs = -1439018031
        TestCaseTwoArgs{lhs: 0b10011101011001101000011111111101, rhs: 600410031, expected: 3241152428}, // lhs = -1654224899
        TestCaseTwoArgs{lhs: 0b11101001111100001010101110111110, rhs: 1080482125, expected: 710378763}, // lhs = -370103362
        TestCaseTwoArgs{lhs: 0b11000100101111101100011110011101, rhs: 722661839, expected: 4023499116}, // lhs = -994130019
        TestCaseTwoArgs{lhs: 0b10100010110001011011100101100001, rhs: 1941842587, expected: 377742332}, // lhs = -1564100255
        TestCaseTwoArgs{lhs: 2014471358, rhs: 403719137, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10100110111000101110110010000110, rhs: 2099102737, expected: 604024983}, // lhs = -1495077754
        TestCaseTwoArgs{lhs: 0b10100111111010111100101010111101, rhs: 1942982923, expected: 465263560}, // lhs = -1477719363
        TestCaseTwoArgs{lhs: 664812287, rhs: 0b11110101111100100100011101011011, expected: 496140890}, // rhs = -168671397
        TestCaseTwoArgs{lhs: 0b11110000000111100101110010010110, rhs: 758251192, expected: 491805518}, // lhs = -266445674
        TestCaseTwoArgs{lhs: 0b10010100010011111100000110101010, rhs: 2098429008, expected: 291716602}, // lhs = -1806712406
        TestCaseTwoArgs{lhs: 0b11101100001111000000001111101111, rhs: 0b10101111010000111101110111011010, expected: 2608849353}, // lhs = -331611153 rhs = -1354506790
        TestCaseTwoArgs{lhs: 1545697295, rhs: 0b11111101100001001101110101111111, expected: 1504073102}, // rhs = -41624193
        TestCaseTwoArgs{lhs: 175742847, rhs: 0b11001000100111110011110011101011, expected: 3541621866}, // rhs = -929088277
        TestCaseTwoArgs{lhs: 1489096134, rhs: 1070925755, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10011011011011100001100010001010, rhs: 2057816198, expected: 370532624}, // lhs = -1687283574
        TestCaseTwoArgs{lhs: 1312345236, rhs: 1838656520, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10000001011111011101100110001001, rhs: 0b10111000000100000100011010010011, expected: 2147483648}, // lhs = -2122458743 rhs = -1206892909
        TestCaseTwoArgs{lhs: 1377127326, rhs: 2108242166, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10011101010111010001101111110101, rhs: 189325483, expected: 2829450400}, // lhs = -1654842379
        TestCaseTwoArgs{lhs: 0b11110001000011001101010101100000, rhs: 0b10010000110001101100111011001001, expected: 2178130985}, // lhs = -250817184 rhs = -1866019127
        TestCaseTwoArgs{lhs: 2059588304, rhs: 906465539, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b11011111110011100110111011100100, rhs: 0b11101101001001111111111111010100, expected: 3438702264}, // lhs = -540119324 rhs = -316145708
        TestCaseTwoArgs{lhs: 1599324860, rhs: 1893040581, expected: 2147483647},
        TestCaseTwoArgs{lhs: 1949294944, rhs: 55792677, expected: 2005087621},
        TestCaseTwoArgs{lhs: 0b11101101101000111100111100110101, rhs: 0b11101101101000010101111111000010, expected: 3678744311}, // lhs = -308031691 rhs = -308191294
        TestCaseTwoArgs{lhs: 0b11010011110100010010010101101101, rhs: 0b11001100001011000110100010111100, expected: 2684194345}, // lhs = -741268115 rhs = -869504836
        TestCaseTwoArgs{lhs: 1580432720, rhs: 1242477920, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10111111110111100001110001011001, rhs: 1985878431, expected: 909915640}, // lhs = -1075962791
        TestCaseTwoArgs{lhs: 548658670, rhs: 502981218, expected: 1051639888},
        TestCaseTwoArgs{lhs: 0b11101011100000100101101111100110, rhs: 0b10001111010101100000111010110111, expected: 2147483648}, // lhs = -343778330 rhs = -1890185545
        TestCaseTwoArgs{lhs: 0b10111000000011010110111100001110, rhs: 0b10111011000110011011000001011111, expected: 2147483648}, // lhs = -1207079154 rhs = -1155944353
        TestCaseTwoArgs{lhs: 0b11011001010101010100100111111111, rhs: 0b11011001101001001010101111101011, expected: 3002725866}, // lhs = -648721921 rhs = -643519509
        TestCaseTwoArgs{lhs: 0b10111010110010001001111011100011, rhs: 0b10110000011011010011010100110101, expected: 2147483648}, // lhs = -1161257245 rhs = -1335020235
        TestCaseTwoArgs{lhs: 203986932, rhs: 0b11010100111111000110111001100100, expected: 3777300056}, // rhs = -721654172
        TestCaseTwoArgs{lhs: 1040552503, rhs: 726338341, expected: 1766890844},
        TestCaseTwoArgs{lhs: 899443280, rhs: 994848530, expected: 1894291810},
        TestCaseTwoArgs{lhs: 0b10001001110110011010001110101011, rhs: 0b11101001001110011111001100001101, expected: 2147483648}, // lhs = -1982225493 rhs = -382078195
        TestCaseTwoArgs{lhs: 0b10000100101110101001101101011000, rhs: 825321270, expected: 3052143246}, // lhs = -2068145320
        TestCaseTwoArgs{lhs: 956379794, rhs: 1894450630, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10110101111011010010110100010011, rhs: 1535954686, expected: 293207057}, // lhs = -1242747629
        TestCaseTwoArgs{lhs: 0b11010000011101111011011010100111, rhs: 399679581, expected: 3897186052}, // lhs = -797460825
        TestCaseTwoArgs{lhs: 0b10101100111101001000010000001110, rhs: 0b11100100010010111001110110111000, expected: 2436899270}, // lhs = -1393261554 rhs = -464806472
        TestCaseTwoArgs{lhs: 1071276201, rhs: 0b11110110011001100110101110101011, expected: 910216276}, // rhs = -161059925
        TestCaseTwoArgs{lhs: 1156743686, rhs: 601710003, expected: 1758453689},
        TestCaseTwoArgs{lhs: 1983839891, rhs: 1841612343, expected: 2147483647},
        TestCaseTwoArgs{lhs: 296261647, rhs: 0b11100010010001110001111111001001, expected: 4092573656}, // rhs = -498655287
        TestCaseTwoArgs{lhs: 1896809424, rhs: 0b10101111000010100110010010000110, expected: 538536022}, // rhs = -1358273402
        TestCaseTwoArgs{lhs: 328404407, rhs: 1525740453, expected: 1854144860},
        TestCaseTwoArgs{lhs: 755735432, rhs: 1325756201, expected: 2081491633},
        TestCaseTwoArgs{lhs: 2126070265, rhs: 0b10001000011010101100000111110011, expected: 119800812}, // rhs = -2006269453
        TestCaseTwoArgs{lhs: 321155599, rhs: 0b11000111100011010101010010111011, expected: 3669083850}, // rhs = -947039045
        TestCaseTwoArgs{lhs: 1193356987, rhs: 1939296962, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0b10110010100110010110000001111000, rhs: 953649917, expected: 3950046069}, // lhs = -1298571144
        TestCaseTwoArgs{lhs: 1453854240, rhs: 0b10100111010100001001010100100110, expected: 4260930374}, // rhs = -1487891162
        TestCaseTwoArgs{lhs: 1410105025, rhs: 0b11111011000111011101001110100001, expected: 1328173666}, // rhs = -81931359
        TestCaseTwoArgs{lhs: 1273474311, rhs: 0b11010000011001111001011011111010, expected: 474956801}, // rhs = -798517510
        TestCaseTwoArgs{lhs: 1854836411, rhs: 0b11101101100000010111100110001000, expected: 1544554563}, // rhs = -310281848
        TestCaseTwoArgs{lhs: 230477254, rhs: 1773783762, expected: 2004261016},
        TestCaseTwoArgs{lhs: 0b10001001100111011011000000111011, rhs: 61521322, expected: 2370334181}, // lhs = -1986154437
        TestCaseTwoArgs{lhs: 0b11011000100010000010111001110100, rhs: 0b10100001001011101011011101110001, expected: 2147483648}, // lhs = -662163852 rhs = -1590773903
        TestCaseTwoArgs{lhs: 1602491244, rhs: 1719948384, expected: 2147483647},
        TestCaseTwoArgs{lhs: 759853926, rhs: 613305010, expected: 1373158936},
        TestCaseTwoArgs{lhs: 0b11001110101011111111000000011110, rhs: 0b10000000100111111001110010000001, expected: 2147483648}, // lhs = -827330530 rhs = -2137023359
        TestCaseTwoArgs{lhs: 1964202164, rhs: 1238259505, expected: 2147483647},
        TestCaseTwoArgs{lhs: 144200888, rhs: 0b10011000000011010011000000111111, expected: 2695202039}, // rhs = -1743966145
        TestCaseTwoArgs{lhs: 1707105328, rhs: 0b10100011111101011011001100000001, expected: 162926385}, // rhs = -1544178943
        TestCaseTwoArgs{lhs: 1606234070, rhs: 578550476, expected: 2147483647},
        TestCaseTwoArgs{lhs: 551001765, rhs: 1742661533, expected: 2147483647},

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 0, expected: 0},
        TestCaseTwoArgs{lhs: 0, rhs: 2147483647, expected: 2147483647},
        TestCaseTwoArgs{lhs: 0, rhs: 0b10000000000000000000000000000000, expected: 2147483648}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0, expected: 2147483647},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 2147483647, expected: 2147483647},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0b10000000000000000000000000000000, expected: 4294967295}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0, expected: 2147483648}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 2147483647, expected: 4294967295}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0b10000000000000000000000000000000, expected: 2147483648}, // lhs = -2147483648 rhs = -2147483648
    ];
    #[test]
    fn test_i32() {
        for case in test_cases.span() {
            assert_eq!(__llvm_sadd_sat_i_i_i(*case.lhs, *case.rhs), *case.expected);
        }
    }
}
