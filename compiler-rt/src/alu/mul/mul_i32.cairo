use crate::rtstate::RTState;
use crate::alu::mul::mul;

pub fn __llvm_mul_i_i_i(ref state: RTState, lhs: u128, rhs: u128) -> u128 {
    mul::<u32>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use crate::rtstate::RTStateOps;
    use super::__llvm_mul_i_i_i;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 129] = [
        // Due to Cairo's casting limitation, negative numbers are represented as bit patterns.

        // Random test cases
        TestCaseTwoArgs{lhs: 0b11000000110001110110001011000100, rhs: 1073861431, expected: 604095516}, // lhs = -1060674876
        TestCaseTwoArgs{lhs: 0b11000110010001010101000110011001, rhs: 393077792, expected: 41645856}, // lhs = -968535655
        TestCaseTwoArgs{lhs: 1097008917, rhs: 1168747688, expected: 0b11000111100110111100000111001000}, // expected = -946093624
        TestCaseTwoArgs{lhs: 967640798, rhs: 0b11110110100001010000111111011000, expected: 0b10110010101110101100110101010000}, // rhs = -159051816 expected = -1296380592
        TestCaseTwoArgs{lhs: 0b10011000000100000001011011100000, rhs: 0b11000000010011111010111011111010, expected: 2120390336}, // lhs = -1743776032 rhs = -1068519686
        TestCaseTwoArgs{lhs: 0b11101111010000000100001001100001, rhs: 1714397703, expected: 177353383}, // lhs = -281001375
        TestCaseTwoArgs{lhs: 0b10101100010000010101111111110010, rhs: 1335105260, expected: 0b10010000011010110011111100011000}, // lhs = -1405001742 expected = -1872019688
        TestCaseTwoArgs{lhs: 1776245111, rhs: 1596923763, expected: 822319477},
        TestCaseTwoArgs{lhs: 527995519, rhs: 329675084, expected: 0b11111011110011111000110010110100}, // expected = -70284108
        TestCaseTwoArgs{lhs: 1361581087, rhs: 0b11111001101111000111101000101110, expected: 0b10011100100011100110001110010010}, // rhs = -105088466 expected = -1668389998
        TestCaseTwoArgs{lhs: 0b10001110011010010011010001101011, rhs: 828632340, expected: 1176512348}, // lhs = -1905707925
        TestCaseTwoArgs{lhs: 0b10010110100000110100100111110011, rhs: 1029027408, expected: 0b11010100010010001101110111110000}, // lhs = -1769780749 expected = -733422096
        TestCaseTwoArgs{lhs: 547935400, rhs: 513805648, expected: 1619983488},
        TestCaseTwoArgs{lhs: 0b10101110001010011011110000110001, rhs: 815332272, expected: 0b10010101010011010110110010110000}, // lhs = -1372996559 expected = -1790088016
        TestCaseTwoArgs{lhs: 0b11011110000011000110110110011111, rhs: 0b11010111001011101101000011101100, expected: 135806612}, // lhs = -569610849 rhs = -684797716
        TestCaseTwoArgs{lhs: 0b10011110100000011111101010110011, rhs: 329961598, expected: 1669911578}, // lhs = -1635648845
        TestCaseTwoArgs{lhs: 0b11000110011010100111010010101101, rhs: 1633924637, expected: 0b11010100111010010011010110011001}, // lhs = -966101843 expected = -722913895
        TestCaseTwoArgs{lhs: 2085442690, rhs: 462069586, expected: 475385764},
        TestCaseTwoArgs{lhs: 652081130, rhs: 1999397492, expected: 0b11110111101100111110101000001000}, // expected = -139204088
        TestCaseTwoArgs{lhs: 0b10000110110101011101111101010100, rhs: 1554183876, expected: 1132573776}, // lhs = -2032804012
        TestCaseTwoArgs{lhs: 1202815741, rhs: 657878928, expected: 2013487440},
        TestCaseTwoArgs{lhs: 1863048499, rhs: 0b11000001010111010000110100010000, expected: 1501588016}, // rhs = -1050866416
        TestCaseTwoArgs{lhs: 1027181846, rhs: 0b10111110101001110001011011101110, expected: 989531764}, // rhs = -1096345874
        TestCaseTwoArgs{lhs: 555371798, rhs: 9908510, expected: 1641037460},
        TestCaseTwoArgs{lhs: 0b11110000110111010111101010000010, rhs: 496010635, expected: 2080837270}, // lhs = -253920638
        TestCaseTwoArgs{lhs: 0b11101000111010111000101111110000, rhs: 0b11100011001011101011100101000111, expected: 0b11000110100101000011111110010000}, // lhs = -387216400 rhs = -483477177 expected = -963362928
        TestCaseTwoArgs{lhs: 0b11101000100000101101111101111010, rhs: 2118396843, expected: 0b10110011010111001100010001111110}, // lhs = -394076294 expected = -1285766018
        TestCaseTwoArgs{lhs: 0b10011001011011110010001111001000, rhs: 1055201282, expected: 270600080}, // lhs = -1720769592
        TestCaseTwoArgs{lhs: 0b11100100001010000000001110110000, rhs: 0b11000010010010111101101101001110, expected: 870887328}, // lhs = -467139664 rhs = -1035216050
        TestCaseTwoArgs{lhs: 0b10010100010001011110000011110001, rhs: 0b10000000011001111110110000101001, expected: 730215065}, // lhs = -1807359759 rhs = -2140672983
        TestCaseTwoArgs{lhs: 0b10100101010111111101101110101111, rhs: 963899043, expected: 283284077}, // lhs = -1520444497
        TestCaseTwoArgs{lhs: 820734647, rhs: 0b11110000100011110001110101000001, expected: 1125503863}, // rhs = -259056319
        TestCaseTwoArgs{lhs: 0b11011100011001001010011010010111, rhs: 365235804, expected: 1249583172}, // lhs = -597383529
        TestCaseTwoArgs{lhs: 0b10010011110001101110101111010000, rhs: 0b11001001010011011101011010010100, expected: 0b11110101101100000011010001000000}, // lhs = -1815680048 rhs = -917645676 expected = -173001664
        TestCaseTwoArgs{lhs: 1160895952, rhs: 56869636, expected: 1210902336},
        TestCaseTwoArgs{lhs: 0b11010010011010010011001001110110, rhs: 1480695914, expected: 1057924316}, // lhs = -764857738
        TestCaseTwoArgs{lhs: 1943311975, rhs: 0b10101111001000100011100000101101, expected: 1072887835}, // rhs = -1356711891
        TestCaseTwoArgs{lhs: 0b10000011111010100000101000101110, rhs: 0b11110101000110010111100011110001, expected: 0b11101000100101110010010101001110}, // lhs = -2081813970 rhs = -182880015 expected = -392747698
        TestCaseTwoArgs{lhs: 823338896, rhs: 684755134, expected: 1044110560},
        TestCaseTwoArgs{lhs: 0b11001100110011011010101001100100, rhs: 0b11100000110011110110011000100111, expected: 1813302588}, // lhs = -858936732 rhs = -523278809
        TestCaseTwoArgs{lhs: 0b11010110111010110011011011001110, rhs: 0b11000100011010110001000100111100, expected: 0b10011101110111101000011001001000}, // lhs = -689228082 rhs = -999616196 expected = -1646361016
        TestCaseTwoArgs{lhs: 0b11001101101001001110110010011001, rhs: 140025608, expected: 0b11111000101100100110101111001000}, // lhs = -844829543 expected = -122524728
        TestCaseTwoArgs{lhs: 0b10111011101011110111101000001110, rhs: 101313856, expected: 0b11111110010110110111100110000000}, // lhs = -1146127858 expected = -27559552
        TestCaseTwoArgs{lhs: 1828989135, rhs: 919222628, expected: 1611401180},
        TestCaseTwoArgs{lhs: 0b10011000110110110000000101011111, rhs: 1483002367, expected: 1063316641}, // lhs = -1730477729
        TestCaseTwoArgs{lhs: 0b10001010110110010011010011101011, rhs: 0b10010111011000011001000000111111, expected: 54736341}, // lhs = -1965476629 rhs = -1755213761
        TestCaseTwoArgs{lhs: 982192257, rhs: 0b10011001001110110010010010011010, expected: 0b10101100101101010001000110011010}, // rhs = -1724177254 expected = -1397419622
        TestCaseTwoArgs{lhs: 0b11000101110010000110110110010001, rhs: 1574819476, expected: 648252884}, // lhs = -976720495
        TestCaseTwoArgs{lhs: 0b11000001110111101111001101001101, rhs: 717119166, expected: 0b11110101111101001101100100100110}, // lhs = -1042353331 expected = -168503002
        TestCaseTwoArgs{lhs: 0b11000011011001010011010111110110, rhs: 0b11100100010001010100000011101101, expected: 0b11010101011111100111010010111110}, // lhs = -1016777226 rhs = -465223443 expected = -713132866
        TestCaseTwoArgs{lhs: 86721028, rhs: 0b10100100110000100010011010111100, expected: 0b11001110100110010001001011110000}, // rhs = -1530779972 expected = -828828944
        TestCaseTwoArgs{lhs: 0b11110010001101010000101001110101, rhs: 0b11010100000100000001000111011100, expected: 915849612}, // lhs = -231404939 rhs = -737144356
        TestCaseTwoArgs{lhs: 560934057, rhs: 0b10110011111101111101010001111111, expected: 0b11101001001100100001101111010111}, // rhs = -1275603841 expected = -382592041
        TestCaseTwoArgs{lhs: 1153016467, rhs: 0b11010110000010111010101011100110, expected: 0b11100011000011101010111000010010}, // rhs = -703878426 expected = -485577198
        TestCaseTwoArgs{lhs: 0b11110010010110101100001010110011, rhs: 0b11110100010100001010110101100011, expected: 0b10000010100111000100001000111001}, // lhs = -228932941 rhs = -196039325 expected = -2103688647
        TestCaseTwoArgs{lhs: 0b10011100100010000100110000010010, rhs: 2017849753, expected: 0b11001101111011000110100011000010}, // lhs = -1668789230 expected = -840144702
        TestCaseTwoArgs{lhs: 0b11011101111001101010011001000001, rhs: 1583499624, expected: 1845367656}, // lhs = -572086719
        TestCaseTwoArgs{lhs: 1442226407, rhs: 824839525, expected: 224343587},
        TestCaseTwoArgs{lhs: 819933605, rhs: 1343008737, expected: 1792437509},
        TestCaseTwoArgs{lhs: 1078069386, rhs: 1016826071, expected: 0b10001111100011000111101111100110}, // expected = -1886618650
        TestCaseTwoArgs{lhs: 0b10001010010000010011010110101101, rhs: 0b10101111111100100000000100000011, expected: 0b11100000100000110100111000000111}, // lhs = -1975437907 rhs = -1343094525 expected = -528265721
        TestCaseTwoArgs{lhs: 2080460752, rhs: 87507576, expected: 0b10101100111000010000100110000000}, // expected = -1394538112
        TestCaseTwoArgs{lhs: 162082398, rhs: 2124886425, expected: 0b10101011010011101011010000101110}, // expected = -1420905426
        TestCaseTwoArgs{lhs: 0b11001001110110011100000011110100, rhs: 554785238, expected: 0b10110100010100000001111111111000}, // lhs = -908476172 expected = -1269817352
        TestCaseTwoArgs{lhs: 755590707, rhs: 1996964831, expected: 827613037},
        TestCaseTwoArgs{lhs: 0b11110101011101011101000001110101, rhs: 0b11100011111101101110010100100111, expected: 0b11010111110110010110101011010011}, // lhs = -176828299 rhs = -470358745 expected = -673617197
        TestCaseTwoArgs{lhs: 982161703, rhs: 0b10110011100101001000101101101001, expected: 328007167}, // rhs = -1282110615
        TestCaseTwoArgs{lhs: 0b10111101111000001001100001010100, rhs: 0b10001011111101010111100110100100, expected: 809847248}, // lhs = -1109354412 rhs = -1946846812
        TestCaseTwoArgs{lhs: 87493631, rhs: 1902274266, expected: 0b10000110010001011101000100100110}, // expected = -2042244826
        TestCaseTwoArgs{lhs: 98329447, rhs: 869757360, expected: 1340460496},
        TestCaseTwoArgs{lhs: 1508215936, rhs: 910058271, expected: 0b10101111001000011000001110000000}, // expected = -1356758144
        TestCaseTwoArgs{lhs: 0b10010101011101001110110111001101, rhs: 653543331, expected: 0b10101100110010110100010010000111}, // lhs = -1787499059 expected = -1395964793
        TestCaseTwoArgs{lhs: 0b10111001011000001111101001000111, rhs: 1077678238, expected: 0b11100010001000101110011111010010}, // lhs = -1184826809 expected = -501028910
        TestCaseTwoArgs{lhs: 582317622, rhs: 697085162, expected: 0b11110000110100100101010101011100}, // expected = -254651044
        TestCaseTwoArgs{lhs: 0b11010011111100010111100111100100, rhs: 0b10010000111000001001011011100010, expected: 0b10000000000110010011001101001000}, // lhs = -739149340 rhs = -1864329502 expected = -2145832120
        TestCaseTwoArgs{lhs: 0b10010100110011110110110100010110, rhs: 0b10000111010000011010100000000001, expected: 16506134}, // lhs = -1798345450 rhs = -2025740287
        TestCaseTwoArgs{lhs: 1274616349, rhs: 0b10100011011011110011001011111100, expected: 971136652}, // rhs = -1552993540
        TestCaseTwoArgs{lhs: 0b11100101010001100010100010010101, rhs: 0b11011110010011011100000110111100, expected: 0b10101110111011110010001001101100}, // lhs = -448386923 rhs = -565329476 expected = -1360059796
        TestCaseTwoArgs{lhs: 0b10011101001000101111100110001001, rhs: 1916724868, expected: 0b11100011011001111100000010100100}, // lhs = -1658652279 expected = -479739740
        TestCaseTwoArgs{lhs: 463367292, rhs: 0b11000000001110110000111101000011, expected: 0b10000011011001011010100001110100}, // rhs = -1069871293 expected = -2090489740
        TestCaseTwoArgs{lhs: 1554180680, rhs: 0b10010010000001010010000110011111, expected: 751487672}, // rhs = -1845157473
        TestCaseTwoArgs{lhs: 0b10000111100011001000100010100010, rhs: 982052766, expected: 643535356}, // lhs = -2020833118
        TestCaseTwoArgs{lhs: 792977728, rhs: 1406698242, expected: 0b11101000110010111000001010000000}, // expected = -389315968
        TestCaseTwoArgs{lhs: 0b11001101101011000010001000101111, rhs: 0b11000101001001110010111111110000, expected: 0b11001011110011111010110100010000}, // lhs = -844357073 rhs = -987287568 expected = -875582192
        TestCaseTwoArgs{lhs: 314289064, rhs: 72121355, expected: 1259716664},
        TestCaseTwoArgs{lhs: 0b11000100000010000111001010011000, rhs: 0b10100000110010111101110101101000, expected: 0b11001100111000111100010111000000}, // lhs = -1006079336 rhs = -1597252248 expected = -857487936
        TestCaseTwoArgs{lhs: 0b11001011100101010011110111111000, rhs: 1631282705, expected: 1002564984}, // lhs = -879411720
        TestCaseTwoArgs{lhs: 1408449377, rhs: 0b10011010101100001111111010110000, expected: 953356464}, // rhs = -1699676496
        TestCaseTwoArgs{lhs: 239412262, rhs: 0b10100101010110110111111110100101, expected: 0b11010111000000010010011001111110}, // rhs = -1520730203 expected = -687790466
        TestCaseTwoArgs{lhs: 583118273, rhs: 0b10001001000100110100010010000011, expected: 1771449795}, // rhs = -1995225981
        TestCaseTwoArgs{lhs: 1630187233, rhs: 2091073776, expected: 419377904},
        TestCaseTwoArgs{lhs: 0b11100100001010001111111000110100, rhs: 1972900504, expected: 219584224}, // lhs = -467075532
        TestCaseTwoArgs{lhs: 1997139527, rhs: 1814236427, expected: 641456141},
        TestCaseTwoArgs{lhs: 1568592885, rhs: 0b10111100101100001111111010000011, expected: 1386450015}, // rhs = -1129251197
        TestCaseTwoArgs{lhs: 21365173, rhs: 0b11110001100001011011100100110110, expected: 604580142}, // rhs = -242894538
        TestCaseTwoArgs{lhs: 173424521, rhs: 918915781, expected: 1024179821},
        TestCaseTwoArgs{lhs: 2139766091, rhs: 0b10101110010111011000000001000101, expected: 0b10111101001001110000010100110111}, // rhs = -1369604027 expected = -1121516233
        TestCaseTwoArgs{lhs: 429716476, rhs: 207786400, expected: 516045184},
        TestCaseTwoArgs{lhs: 1116648520, rhs: 0b11100110000000001100001011100000, expected: 293359360}, // rhs = -436157728
        TestCaseTwoArgs{lhs: 0b10110011100001101000101000010110, rhs: 1111341589, expected: 228282318}, // lhs = -1283028458
        TestCaseTwoArgs{lhs: 1443841922, rhs: 1855026433, expected: 0b10101110010111111011000110000010}, // expected = -1369460350
        TestCaseTwoArgs{lhs: 1172757747, rhs: 0b10111011110011011101100111101011, expected: 1271778833}, // rhs = -1144137237
        TestCaseTwoArgs{lhs: 0b10000001000001001010111101100111, rhs: 0b11111011000110011110101111110000, expected: 1601633680}, // lhs = -2130399385 rhs = -82187280
        TestCaseTwoArgs{lhs: 0b11111011010000000100101011110000, rhs: 0b10111100111110001101101101111100, expected: 0b10001011101111111001110001000000}, // lhs = -79672592 rhs = -1124541572 expected = -1950376896
        TestCaseTwoArgs{lhs: 0b11010110010000101011100010101011, rhs: 1115363862, expected: 10894514}, // lhs = -700270421
        TestCaseTwoArgs{lhs: 1028613663, rhs: 0b10000100001000101100000011010000, expected: 0b11101001001110000011100100110000}, // rhs = -2078097200 expected = -382191312
        TestCaseTwoArgs{lhs: 1244158446, rhs: 0b10001000110010001100001011100011, expected: 131996170}, // rhs = -2000108829
        TestCaseTwoArgs{lhs: 9884741, rhs: 818475404, expected: 372837052},
        TestCaseTwoArgs{lhs: 0b10010010110000011000100100111111, rhs: 0b10100001011101110110110011101100, expected: 1536825876}, // lhs = -1832810177 rhs = -1586008852
        TestCaseTwoArgs{lhs: 0b10110011001110000000100010010010, rhs: 618362337, expected: 0b11111101000100000100001001010010}, // lhs = -1288173422 expected = -49266094
        TestCaseTwoArgs{lhs: 1979851579, rhs: 459831839, expected: 0b11011000000001000110001000100101}, // expected = -670801371
        TestCaseTwoArgs{lhs: 197580542, rhs: 1896324927, expected: 1684580994},
        TestCaseTwoArgs{lhs: 0b10101010000001110000100110010011, rhs: 0b11100110000110110101110001010011, expected: 0b10111100001110011110111010101001}, // lhs = -1442379373 rhs = -434414509 expected = -1137054039
        TestCaseTwoArgs{lhs: 0b10001000011010110010101011111100, rhs: 0b11000110010110001110101001100000, expected: 0b11001100000110100111011010000000}, // lhs = -2006242564 rhs = -967251360 expected = -870680960
        TestCaseTwoArgs{lhs: 2071244333, rhs: 1386476874, expected: 0b10101011000100100110101000000010}, // expected = -1424856574
        TestCaseTwoArgs{lhs: 690347940, rhs: 958181859, expected: 0b10100110001001011011001001101100}, // expected = -1507478932
        TestCaseTwoArgs{lhs: 0b11101011011110010110010110001101, rhs: 0b10111010000111100010011110101010, expected: 899410594}, // lhs = -344365683 rhs = -1172428886
        TestCaseTwoArgs{lhs: 1264660648, rhs: 0b10011110100101110111001111011110, expected: 1782294960}, // rhs = -1634241570
        TestCaseTwoArgs{lhs: 0b10011111110110111101111110110111, rhs: 994642617, expected: 349229375}, // lhs = -1612980297
        TestCaseTwoArgs{lhs: 0b11111011010000101011000000010010, rhs: 1136499663, expected: 1053901966}, // lhs = -79515630

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 0, expected: 0},
        TestCaseTwoArgs{lhs: 0, rhs: 2147483647, expected: 0},
        TestCaseTwoArgs{lhs: 0, rhs: 0b10000000000000000000000000000000, expected: 0}, // rhs = -2147483648
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0, expected: 0},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 2147483647, expected: 1},
        TestCaseTwoArgs{lhs: 2147483647, rhs: 0b10000000000000000000000000000000, expected: 0b10000000000000000000000000000000}, // rhs = -2147483648 expected = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0, expected: 0}, // lhs = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 2147483647, expected: 0b10000000000000000000000000000000}, // lhs = -2147483648 expected = -2147483648
        TestCaseTwoArgs{lhs: 0b10000000000000000000000000000000, rhs: 0b10000000000000000000000000000000, expected: 0}, // lhs = -2147483648 rhs = -2147483648
    ];
    #[test]
    fn test_i32() {
        for case in test_cases.span() {
            let mut state = RTStateOps::new();
            assert_eq!(__llvm_mul_i_i_i(ref state, *case.lhs, *case.rhs), *case.expected);
        }
    }
}
