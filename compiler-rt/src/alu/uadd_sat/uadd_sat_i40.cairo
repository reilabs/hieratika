use crate::rtstate::RTState;
use crate::alu::uadd_sat::uadd_sat;
use crate::integer::u40::u40;

pub fn __llvm_uadd_sat_n_n_n(ref state: RTState, lhs: u128, rhs: u128) -> u128 {
    uadd_sat::<u40>(lhs, rhs)
}

#[cfg(test)]
mod tests {
    use crate::rtstate::RTStateOps;
    use super::__llvm_uadd_sat_n_n_n;
    use crate::alu::test_case::TestCaseTwoArgs;
    #[cairofmt::skip]
    pub const test_cases: [TestCaseTwoArgs; 204] = [
        // Random test cases
        TestCaseTwoArgs{lhs: 224422711495, rhs: 152857723138, expected: 377280434633},
        TestCaseTwoArgs{lhs: 161704766577, rhs: 743396551423, expected: 905101318000},
        TestCaseTwoArgs{lhs: 96357791399, rhs: 132213437388, expected: 228571228787},
        TestCaseTwoArgs{lhs: 992029413538, rhs: 816939575737, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 437628473766, rhs: 893290424962, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 23023028575, rhs: 144534164952, expected: 167557193527},
        TestCaseTwoArgs{lhs: 899530951049, rhs: 891340070625, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 56014277132, rhs: 300369134315, expected: 356383411447},
        TestCaseTwoArgs{lhs: 890380223871, rhs: 729532578681, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 460803294552, rhs: 654779885957, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 577806433034, rhs: 901598403783, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 322933254009, rhs: 872965209497, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1069824723808, rhs: 359312867037, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 522932887613, rhs: 761226850205, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 764322562910, rhs: 124121344062, expected: 888443906972},
        TestCaseTwoArgs{lhs: 495574054986, rhs: 991418595604, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 669907409464, rhs: 190949752599, expected: 860857162063},
        TestCaseTwoArgs{lhs: 1005194586495, rhs: 858890507492, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 459891499515, rhs: 494438356218, expected: 954329855733},
        TestCaseTwoArgs{lhs: 1046535651151, rhs: 381467729578, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 365488761942, rhs: 629642406621, expected: 995131168563},
        TestCaseTwoArgs{lhs: 303864647247, rhs: 243830661299, expected: 547695308546},
        TestCaseTwoArgs{lhs: 962052428971, rhs: 757779330879, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 2453021326, rhs: 1060059768190, expected: 1062512789516},
        TestCaseTwoArgs{lhs: 417251748100, rhs: 516945786010, expected: 934197534110},
        TestCaseTwoArgs{lhs: 131607203347, rhs: 441150200444, expected: 572757403791},
        TestCaseTwoArgs{lhs: 764757201697, rhs: 226795717266, expected: 991552918963},
        TestCaseTwoArgs{lhs: 38597705296, rhs: 1042376250660, expected: 1080973955956},
        TestCaseTwoArgs{lhs: 99989245762, rhs: 64247204273, expected: 164236450035},
        TestCaseTwoArgs{lhs: 541320606952, rhs: 491462399873, expected: 1032783006825},
        TestCaseTwoArgs{lhs: 958185596674, rhs: 628447805575, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 832704212410, rhs: 677965362721, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1036876328539, rhs: 748565760079, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 219724770413, rhs: 146295700516, expected: 366020470929},
        TestCaseTwoArgs{lhs: 541761501834, rhs: 605504054190, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 423331446707, rhs: 899022840889, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 327284861683, rhs: 503943643009, expected: 831228504692},
        TestCaseTwoArgs{lhs: 1025059135252, rhs: 167104679022, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 408310030492, rhs: 169991922739, expected: 578301953231},
        TestCaseTwoArgs{lhs: 486825398614, rhs: 95557308693, expected: 582382707307},
        TestCaseTwoArgs{lhs: 133817518401, rhs: 941596233797, expected: 1075413752198},
        TestCaseTwoArgs{lhs: 855156203717, rhs: 30262779056, expected: 885418982773},
        TestCaseTwoArgs{lhs: 297877537508, rhs: 1024641556160, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 170612234233, rhs: 810895205998, expected: 981507440231},
        TestCaseTwoArgs{lhs: 340821763558, rhs: 863680454597, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 67222231449, rhs: 975262093386, expected: 1042484324835},
        TestCaseTwoArgs{lhs: 595579677462, rhs: 981247612713, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 33044126725, rhs: 50296669817, expected: 83340796542},
        TestCaseTwoArgs{lhs: 669001194010, rhs: 200636719505, expected: 869637913515},
        TestCaseTwoArgs{lhs: 1053580939003, rhs: 489205335199, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1048899699340, rhs: 7471166550, expected: 1056370865890},
        TestCaseTwoArgs{lhs: 298011454107, rhs: 291328735082, expected: 589340189189},
        TestCaseTwoArgs{lhs: 647457815956, rhs: 763071597052, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 761526384396, rhs: 315420842582, expected: 1076947226978},
        TestCaseTwoArgs{lhs: 257734746540, rhs: 486987465702, expected: 744722212242},
        TestCaseTwoArgs{lhs: 918705730971, rhs: 577830487728, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 445116133617, rhs: 656903542796, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1068716908048, rhs: 1082797510858, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 857351856320, rhs: 572098311813, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 492650048039, rhs: 254140119835, expected: 746790167874},
        TestCaseTwoArgs{lhs: 537930937375, rhs: 305988367629, expected: 843919305004},
        TestCaseTwoArgs{lhs: 715498826370, rhs: 450362939669, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 272317628554, rhs: 207733016061, expected: 480050644615},
        TestCaseTwoArgs{lhs: 594994176921, rhs: 788663244738, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 26074103644, rhs: 771569389347, expected: 797643492991},
        TestCaseTwoArgs{lhs: 576109661432, rhs: 414933732418, expected: 991043393850},
        TestCaseTwoArgs{lhs: 1066460820673, rhs: 485752257070, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 758701134537, rhs: 1002961765947, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 737522806277, rhs: 998837214243, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 277689296476, rhs: 255889394421, expected: 533578690897},
        TestCaseTwoArgs{lhs: 281819051545, rhs: 684043382638, expected: 965862434183},
        TestCaseTwoArgs{lhs: 56842058251, rhs: 441316205962, expected: 498158264213},
        TestCaseTwoArgs{lhs: 467785516557, rhs: 529285414243, expected: 997070930800},
        TestCaseTwoArgs{lhs: 652065263533, rhs: 1004992709245, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 777955175632, rhs: 1093884167259, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 520494512719, rhs: 593267156892, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 847524103351, rhs: 816892303191, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 865077222687, rhs: 78242523696, expected: 943319746383},
        TestCaseTwoArgs{lhs: 437502856726, rhs: 520455751306, expected: 957958608032},
        TestCaseTwoArgs{lhs: 168457481998, rhs: 396714090113, expected: 565171572111},
        TestCaseTwoArgs{lhs: 72221606306, rhs: 283318402450, expected: 355540008756},
        TestCaseTwoArgs{lhs: 750310416480, rhs: 608562859135, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 561569173065, rhs: 496364100442, expected: 1057933273507},
        TestCaseTwoArgs{lhs: 281369521622, rhs: 560560043154, expected: 841929564776},
        TestCaseTwoArgs{lhs: 251987401492, rhs: 12288038496, expected: 264275439988},
        TestCaseTwoArgs{lhs: 505740208716, rhs: 757896786735, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 661958415058, rhs: 32819557872, expected: 694777972930},
        TestCaseTwoArgs{lhs: 587936092569, rhs: 64534852873, expected: 652470945442},
        TestCaseTwoArgs{lhs: 423637654852, rhs: 110098754583, expected: 533736409435},
        TestCaseTwoArgs{lhs: 238682281954, rhs: 923043352923, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 753521042782, rhs: 831283342221, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 466553560489, rhs: 125582252003, expected: 592135812492},
        TestCaseTwoArgs{lhs: 948795667998, rhs: 670018770003, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 134751884891, rhs: 377014813810, expected: 511766698701},
        TestCaseTwoArgs{lhs: 460505180004, rhs: 613347610811, expected: 1073852790815},
        TestCaseTwoArgs{lhs: 746112619404, rhs: 39806108516, expected: 785918727920},
        TestCaseTwoArgs{lhs: 172513002739, rhs: 1013461098298, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 613707005304, rhs: 554330505583, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 648124942401, rhs: 751799941798, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 449236591153, rhs: 961433394478, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 98843725031, rhs: 129352917602, expected: 228196642633},
        TestCaseTwoArgs{lhs: 1045843124282, rhs: 703351942789, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 269996129758, rhs: 823170419881, expected: 1093166549639},
        TestCaseTwoArgs{lhs: 146220860460, rhs: 455741540483, expected: 601962400943},
        TestCaseTwoArgs{lhs: 356403701897, rhs: 847910612923, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 524813229089, rhs: 165089311478, expected: 689902540567},
        TestCaseTwoArgs{lhs: 118289113006, rhs: 1059199210787, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 744939020783, rhs: 616185871390, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1028694534751, rhs: 621847114827, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 919123616613, rhs: 179081913752, expected: 1098205530365},
        TestCaseTwoArgs{lhs: 500784063520, rhs: 806372160926, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 376555974259, rhs: 682570644423, expected: 1059126618682},
        TestCaseTwoArgs{lhs: 998323265566, rhs: 309412020811, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 348500040865, rhs: 342918222364, expected: 691418263229},
        TestCaseTwoArgs{lhs: 700661986448, rhs: 267889242554, expected: 968551229002},
        TestCaseTwoArgs{lhs: 767231739422, rhs: 917721933415, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 821898090296, rhs: 224358088942, expected: 1046256179238},
        TestCaseTwoArgs{lhs: 936581320890, rhs: 388168119583, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 383598359083, rhs: 1094762745818, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 533238463152, rhs: 1002726382463, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 108419697391, rhs: 31549277670, expected: 139968975061},
        TestCaseTwoArgs{lhs: 321605010, rhs: 739148605287, expected: 739470210297},
        TestCaseTwoArgs{lhs: 341367381687, rhs: 595283632747, expected: 936651014434},
        TestCaseTwoArgs{lhs: 974444118313, rhs: 255609615460, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 742942144056, rhs: 1008800931582, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 722855409191, rhs: 129266135966, expected: 852121545157},
        TestCaseTwoArgs{lhs: 323907136569, rhs: 243705849828, expected: 567612986397},
        TestCaseTwoArgs{lhs: 698768766085, rhs: 901407369725, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 924195213954, rhs: 214249455543, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 565907340969, rhs: 213122988983, expected: 779030329952},
        TestCaseTwoArgs{lhs: 141886010295, rhs: 723507594030, expected: 865393604325},
        TestCaseTwoArgs{lhs: 929051391305, rhs: 853368209118, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 819390008817, rhs: 923004053420, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 542401571860, rhs: 127753994288, expected: 670155566148},
        TestCaseTwoArgs{lhs: 397803990132, rhs: 915341269028, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1048378337041, rhs: 260659855742, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 471013474831, rhs: 705514681954, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 989293217318, rhs: 731207468874, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 558587309699, rhs: 989440404192, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 387659743456, rhs: 32736973812, expected: 420396717268},
        TestCaseTwoArgs{lhs: 1099051114466, rhs: 103790587591, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 216262992067, rhs: 84659431639, expected: 300922423706},
        TestCaseTwoArgs{lhs: 958426089784, rhs: 607460249048, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 151909141514, rhs: 235980555188, expected: 387889696702},
        TestCaseTwoArgs{lhs: 1039597730281, rhs: 1079719957776, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 283587629971, rhs: 189107557667, expected: 472695187638},
        TestCaseTwoArgs{lhs: 366521037303, rhs: 570845438062, expected: 937366475365},
        TestCaseTwoArgs{lhs: 109377913777, rhs: 984843020687, expected: 1094220934464},
        TestCaseTwoArgs{lhs: 977880282885, rhs: 93155397998, expected: 1071035680883},
        TestCaseTwoArgs{lhs: 518972787996, rhs: 14506799598, expected: 533479587594},
        TestCaseTwoArgs{lhs: 113335157533, rhs: 488830000540, expected: 602165158073},
        TestCaseTwoArgs{lhs: 356790658823, rhs: 304715249485, expected: 661505908308},
        TestCaseTwoArgs{lhs: 840824663158, rhs: 470334588660, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 345822607993, rhs: 593760777040, expected: 939583385033},
        TestCaseTwoArgs{lhs: 762465423837, rhs: 950094403129, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 549934335656, rhs: 191677086662, expected: 741611422318},
        TestCaseTwoArgs{lhs: 73072165391, rhs: 490871765827, expected: 563943931218},
        TestCaseTwoArgs{lhs: 229177082802, rhs: 607993842149, expected: 837170924951},
        TestCaseTwoArgs{lhs: 173129563449, rhs: 907647710019, expected: 1080777273468},
        TestCaseTwoArgs{lhs: 892913851160, rhs: 276637322779, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 632628656233, rhs: 20643956545, expected: 653272612778},
        TestCaseTwoArgs{lhs: 687499145547, rhs: 81815291305, expected: 769314436852},
        TestCaseTwoArgs{lhs: 482305090481, rhs: 752956817655, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 502001948130, rhs: 294065838428, expected: 796067786558},
        TestCaseTwoArgs{lhs: 414734867741, rhs: 1099451455470, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1025932460285, rhs: 625387923245, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 690220405103, rhs: 307635674085, expected: 997856079188},
        TestCaseTwoArgs{lhs: 668052269972, rhs: 115969791302, expected: 784022061274},
        TestCaseTwoArgs{lhs: 774887391466, rhs: 994514485938, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 498377955681, rhs: 1015922075613, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1018886165577, rhs: 1072101080342, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 36026867411, rhs: 752605117142, expected: 788631984553},
        TestCaseTwoArgs{lhs: 967404401120, rhs: 247855313293, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 571517271906, rhs: 218950012244, expected: 790467284150},
        TestCaseTwoArgs{lhs: 276385944519, rhs: 545079464751, expected: 821465409270},
        TestCaseTwoArgs{lhs: 872301100865, rhs: 435326215692, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 361899694156, rhs: 173805379034, expected: 535705073190},
        TestCaseTwoArgs{lhs: 978543816479, rhs: 1097009584703, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 698964924747, rhs: 923645040852, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 297273532776, rhs: 149510207744, expected: 446783740520},
        TestCaseTwoArgs{lhs: 156158358877, rhs: 6889502882, expected: 163047861759},
        TestCaseTwoArgs{lhs: 766635258295, rhs: 616613565569, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 215002827733, rhs: 44378753493, expected: 259381581226},
        TestCaseTwoArgs{lhs: 481501380124, rhs: 937268210597, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1070109017225, rhs: 374205517265, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 114287778283, rhs: 130250110736, expected: 244537889019},
        TestCaseTwoArgs{lhs: 970515239770, rhs: 153743532349, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 947996392363, rhs: 177982116593, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 359326840078, rhs: 161457811901, expected: 520784651979},
        TestCaseTwoArgs{lhs: 560634057820, rhs: 119917892639, expected: 680551950459},
        TestCaseTwoArgs{lhs: 1054362794340, rhs: 105289605249, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 951605764629, rhs: 71681858360, expected: 1023287622989},
        TestCaseTwoArgs{lhs: 582214660665, rhs: 42933829841, expected: 625148490506},
        TestCaseTwoArgs{lhs: 662591186715, rhs: 577945166475, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 479804084490, rhs: 457447179865, expected: 937251264355},
        TestCaseTwoArgs{lhs: 287120057597, rhs: 41665670737, expected: 328785728334},
        TestCaseTwoArgs{lhs: 1081542388131, rhs: 981262479531, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 160097481850, rhs: 136860259818, expected: 296957741668},
        TestCaseTwoArgs{lhs: 711356279140, rhs: 511791131419, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 888079787583, rhs: 280361572533, expected: 1099511627775},

        // Edge cases
        TestCaseTwoArgs{lhs: 0, rhs: 0, expected: 0},
        TestCaseTwoArgs{lhs: 0, rhs: 1099511627775, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1099511627775, rhs: 0, expected: 1099511627775},
        TestCaseTwoArgs{lhs: 1099511627775, rhs: 1099511627775, expected: 1099511627775},
    ];

    #[test]
    fn test_i40() {
        for case in test_cases.span() {
            let mut state = RTStateOps::new();
            assert_eq!(__llvm_uadd_sat_n_n_n(ref state, *case.lhs, *case.rhs), *case.expected);
        }
    }
}
